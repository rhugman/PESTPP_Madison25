<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>simple_ies â€“ PESTPP Madison Tutorials</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-16ed6b721fb3ed5dec6e8ac5c8ff3b6f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PESTPP Madison Tutorials</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.qmd"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../notebooks/simple_pstfrom.html">
 <span class="dropdown-text">Simple PSTFrom</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../notebooks/simple_ies.html">
 <span class="dropdown-text">Simple IES</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../notebooks/simple_LP_example.html">
 <span class="dropdown-text">Simple LP Example</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notebooks/simple_ies.html">simple_ies.html</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/simple_pstfrom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">simple_pstfrom.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/simple_ies.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">simple_ies.html</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks/simple_LP_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Linear Programming Example</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><h1 class="title display-7"></h1></header><div class="quarto-title-block"><div class="quarto-title-tools-only"><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>




<div id="a0bcc856-86f0-47bb-b201-af2d9335ca57" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:53.695410Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:53.694961Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.421696Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.421184Z&quot;}}" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>sys.path.insert(<span class="dv">0</span>,<span class="st">".."</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyemu</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pyemu.<span class="va">__file__</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> flopy</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> platform</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>/home/runner/work/PESTPP_Madison25/PESTPP_Madison25/dependencies/pyemu/pyemu/__init__.py</code></pre>
</div>
</div>
<div id="0bc68af4-4c11-438b-9bfd-52ddded58869" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.423398Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.423155Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.426050Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.425643Z&quot;}}" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>t_d <span class="op">=</span> <span class="st">"template"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(t_d):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">"need to run simple_pstfrom notebook"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="4a4489e7-7066-4b3b-9d89-6080341732ae" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.427570Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.427400Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.465574Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.465099Z&quot;}}" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pst <span class="op">=</span> pyemu.Pst(os.path.join(t_d,<span class="st">"at.pst"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>pst.npar,pst.nobs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>(212, 2048)</code></pre>
</div>
</div>
<div id="ea9ff327-0b96-4231-a8b8-71367090145a" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.467086Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.466935Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.470335Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.469828Z&quot;}}" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pst.pestpp_options</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>{'ies_par_en': 'prior.csv'}</code></pre>
</div>
</div>
<div id="e1d96d0c-5b11-41d1-be28-7413358a05d1" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.471812Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.471659Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.473999Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.473610Z&quot;}}" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"ies_par_en"</span> <span class="kw">not</span> <span class="kw">in</span> pst.pestpp_options:</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="st">"prior par ensemble not found"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="5f3e9ce9-7a05-4579-a76c-a5a905401707" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.475630Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.475218Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.479096Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.478598Z&quot;}}" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pst.pestpp_options <span class="op">=</span> {<span class="st">"ies_par_en"</span>:pst.pestpp_options[<span class="st">"ies_par_en"</span>]}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pst.pestpp_options[<span class="st">"ies_num_reals"</span>] <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>pst.pestpp_options[<span class="st">"ies_bad_phi_sigma"</span>] <span class="op">=</span> <span class="fl">1.75</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>pst.pestpp_options</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>{'ies_par_en': 'prior.csv', 'ies_num_reals': 50, 'ies_bad_phi_sigma': 1.75}</code></pre>
</div>
</div>
<div id="8c5da2b9-9c40-4f90-ae64-97a7b5617749" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.480576Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.480410Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.483149Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.482647Z&quot;}}" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pst.control_data.noptmax <span class="op">=</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="f31795f0" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.484528Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.484346Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.488224Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.487700Z&quot;}}" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pst.obs_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>['oname:chd.csv_otype:lst_usecol:chdflow',
 'headgroup',
 'headdiffgroup',
 'rivgroup',
 'oname:at.budget.csv_otype:lst_usecol:chd(chd-1)_in',
 'oname:at.budget.csv_otype:lst_usecol:chd(chd-1)_out',
 'oname:at.budget.csv_otype:lst_usecol:percent_difference',
 'oname:at.budget.csv_otype:lst_usecol:rcha(rch-1)_in',
 'oname:at.budget.csv_otype:lst_usecol:rcha(rch-1)_out',
 'oname:at.budget.csv_otype:lst_usecol:riv(riv-1)_in',
 'oname:at.budget.csv_otype:lst_usecol:riv(riv-1)_out',
 'oname:at.budget.csv_otype:lst_usecol:total_in',
 'oname:at.budget.csv_otype:lst_usecol:total_out',
 'oname:at.budget.csv_otype:lst_usecol:wel(wel-1)_in',
 'oname:at.budget.csv_otype:lst_usecol:wel(wel-1)_out',
 'oname:k_aq.ref_otype:arr',
 'oname:k_clay.ref_otype:arr']</code></pre>
</div>
</div>
<div id="ea9570e1" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.489650Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.489471Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.493439Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.493053Z&quot;}}" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>weighted_groups <span class="op">=</span> pst.nnz_obs_groups</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>weighted_groups.sort()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>weighted_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>['headdiffgroup', 'headgroup', 'rivgroup']</code></pre>
</div>
</div>
<div id="04c12b25" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.494900Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.494743Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.497159Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.496754Z&quot;}}" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>wts <span class="op">=</span> [<span class="fl">1e-30</span>,<span class="fl">.8</span>,<span class="fl">.2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ecf9df3b" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.498571Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.498411Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.501268Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.500909Z&quot;}}" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f'</span><span class="sc">{</span>t_d<span class="sc">}</span><span class="ss">/phi_factors.csv'</span>, <span class="st">'w'</span>) <span class="im">as</span> ofp:</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    [ofp.write(<span class="ss">f'</span><span class="sc">{</span>g<span class="sc">}</span><span class="ss">,</span><span class="sc">{</span>w<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>) <span class="cf">for</span> g,w <span class="kw">in</span> <span class="bu">zip</span>(weighted_groups,wts)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="2f9c96ea" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.502647Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.502477Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.505105Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.504609Z&quot;}}" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pst.pestpp_options[<span class="st">'ies_phi_factor_file'</span>]<span class="op">=</span><span class="st">'phi_factors.csv'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="10534e3a-1dbb-4696-9a81-07833d7a4de3" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.506540Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.506374Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.530698Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.530148Z&quot;}}" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pst.write(os.path.join(t_d,<span class="st">"at.pst"</span>),version<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>noptmax:5, npar_adj:212, nnz_obs:36</code></pre>
</div>
</div>
<div id="bffee342-a97e-4112-a8f7-4c295f91b026" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.532479Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.532172Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:01:54.534708Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:01:54.534205Z&quot;}}" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m_d <span class="op">=</span> <span class="st">"master_ies_simple"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="9485ba84-b53f-452e-92cc-1a90075dd01e" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:01:54.536146Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:01:54.535990Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:05:29.910031Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:05:29.909272Z&quot;}}" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pyemu.os_utils.start_workers(t_d,<span class="st">"pestpp-ies"</span>,<span class="st">"at.pst"</span>,num_workers<span class="op">=</span><span class="dv">15</span>,master_dir<span class="op">=</span>m_d,worker_root<span class="op">=</span><span class="st">'.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>

             pestpp-ies: a GLM iterative ensemble smoother

                   by the PEST++ development team


version: 5.2.21
binary compiled on Jul 14 2025 at 14:36:32

started at 07/18/25 11:01:54
...processing command line: ' ./pestpp-ies at.pst /h :4004'
...using panther run manager in master mode using port 4004

using control file: "at.pst"
in directory: "/home/runner/work/PESTPP_Madison25/PESTPP_Madison25/notebooks/master_ies_simple"
on host: "pkrvmq0rgcvqdmg"

processing control file at.pst


:~-._                                                 _.-~:
: :.~^o._        ________---------________        _.o^~.:.:
 : ::.`?88booo~~~.::::::::...::::::::::::..~~oood88P'.::.:
 :  ::: `?88P .:::....         ........:::::. ?88P' :::. :
  :  :::. `? .::.            . ...........:::. P' .:::. :
   :  :::   ... ..  ...       .. .::::......::.   :::. :
   `  :' .... ..  .:::::.     . ..:::::::....:::.  `: .'
    :..    ____:::::::::.  . . ....:::::::::____  ... :
   :... `:~    ^~-:::::..  .........:::::-~^    ~::.::::
   `.::. `\   (8)  \b:::..::.:.:::::::d/  (8)   /'.::::'
    ::::.  ~-._v    |b.::::::::::::::d|    v_.-~..:::::
    `.:::::... ~~^?888b..:::::::::::d888P^~...::::::::'
     `.::::::::::....~~~ .:::::::::~~~:::::::::::::::'
      `..:::::::::::   .   ....::::    ::::::::::::,'
        `. .:::::::    .      .::::.    ::::::::'.'
          `._ .:::    .        :::::.    :::::_.'
             `-. :    .        :::::      :,-'
                :.   :___     .:::___   .::
      ..--~~~~--:+::. ~~^?b..:::dP^~~.::++:--~~~~--..
        ___....--`+:::.    `~8~'    .:::+'--....___
      ~~   __..---`_=:: ___gd8bg___ :==_'---..__   ~~
       -~~~  _.--~~`-.~~~~~~~~~~~~~~~,-' ~~--._ ~~~-


               starting PANTHER master...

IP addresses:
  0.0.0.0:4004 (IPv4)

PANTHER master listening on socket: 0.0.0.0:4004 (IPv4)

  ---  initializing  ---  
...checking phi factors in file phi_factors.csv
...using glm algorithm
...using REDSVD for truncated svd solve
...maxsing: 10000000
...eigthresh:  1e-06
...initializing localizer
...not using localization
...using lambda multipliers: 0.1 , 1 , 10 , 
...using lambda scaling factors: 0.75 , 1 , 1.1 , 
...acceptable phi factor:  1.05
...lambda increase factor:  10
...lambda decrease factor:  0.75
...max run fail:  1
...initializing prior parameter covariance matrix
...parcov loaded  from parameter bounds, using par_sigma_range 4
...initializing observation noise covariance matrix
...obscov loaded  from observation weights
...using reg_factor:  0
...loading par ensemble from csv file prior.csv
...ies_num_reals arg passed, truncated parameter ensemble to  50
...not using prior parameter covariance matrix scaling
...drawing observation noise realizations:  50
observations not grouped by observations groups, reordering obs ensemble
...setting weights ensemble from control file weights
...saved weight ensemble to  at.weights.csv
...adding 'base' parameter values to ensemble
...adding 'base' observation values to ensemble
...adding 'base' weight values to weight ensemble
...saved initial parameter ensemble to  at.0.par.csv
...saved obs+noise observation ensemble (obsval + noise realizations) to  at.obs+noise.csv
...using subset in lambda testing, percentage of realizations used in subset testing:  10
...subset how:  RANDOM
...centering on ensemble mean vector
...running initial ensemble of size 50
    running model 50 times
    starting at 07/18/25 11:01:54

    waiting for agents to appear...


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:01:55 mn:0     runs(C0    |F0    |T0    ) agents(R6   |W0   |U4   ) 0  07/18 11:01:56 mn:0     runs(C0    |F0    |T0    ) agents(R12  |W0   |U2   ) 0  07/18 11:01:57 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:01:58 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:01:59 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:00 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:01 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:02 mn:0.12  runs(C4    |F0    |T0    ) agents(R14  |W0   |U1   ) 0  07/18 11:02:03 mn:0.12  runs(C9    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:04 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:05 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:06 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:07 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:08 mn:0.12  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:09 mn:0.12  runs(C19   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:10 mn:0.12  runs(C21   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:11 mn:0.12  runs(C30   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:12 mn:0.12  runs(C30   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:13 mn:0.12  runs(C31   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:14 mn:0.12  runs(C31   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:15 mn:0.12  runs(C35   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:16 mn:0.12  runs(C35   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:17 mn:0.12  runs(C36   |F0    |T0    ) agents(R14  |W0   |U1   ) 0  07/18 11:02:18 mn:0.12  runs(C41   |F0    |T0    ) agents(R9   |W5   |U1   ) 0  07/18 11:02:19 mn:0.12  runs(C46   |F0    |T0    ) agents(R4   |W11  |U0   ) 0  07/18 11:02:20 remaining file transfers: 0

   50 runs complete :  0 runs failed
   0.114 avg run time (min) : 0.421 run mgr time (min)
   15 agents connected


...saved initial obs ensemble to at.0.obs.csv
saved par and rei files for realization BASE for iteration 0
saved par and rei files for realization BASE

  ---  pre-drop initial phi summary  ---  
       phi type           mean            std            min            max
       measured        2241.65        3212.65        45.5365        16349.2
         actual        2200.44        3226.06        18.7208        16422.3
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
rivgroup            2          0  1.24e+03  1.77e+03      1.58   8.1e+03      68.1      36.5
headgroup          31          0       965  3.07e+03      17.1  1.64e+04      31.9      36.5
headdiffgroup       3          3    0.0298    0.0231    0.0148     0.134   0.00654    0.0163

...checking for prior-data conflict

  ---  WARNING: 3 non-zero weighted observations are in conflict with the prior simulated ensemble.
  ---  
...see at.0.pdc.csv for listing of conflicted observations

...  WARNING: Prior-data conflict detected.  Continuing with IES parameter
           adjustment will likely result in parameter and forecast bias.


  ---  dropping realizations as bad:  4  ---  
...dropping par:obs realizations: 3 : 3 , 6 : 6 , 37 : 37 , 42 : 42 , 

  ---  adjusting weights using phi factors in file phi_factors.csv  ---  

  ---  pre-weight-adjustment initial phi summary  ---  
       phi type           mean            std            min            max
       measured        1454.12        1539.18        45.5365        6408.03
         actual        1403.84        1511.19        18.7208        6162.19
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
rivgroup            2          0  1.16e+03   1.5e+03      1.58  6.09e+03      71.9      33.3
headgroup          31          0       239       627      17.1   4.1e+03      28.1      33.3
headdiffgroup       3          3    0.0249    0.0101    0.0148    0.0719   0.00704    0.0169

...checking phi factors in file phi_factors.csv
...using mean residuals for reweighting
...original mean phi:  1454.12
...file tag 'HEADDIFFGROUP' original mean phi (factor): 0.0248823 (1.71115e-05)
...file tag 'HEADGROUP' original mean phi (factor): 272.994 (0.187738)
...file tag 'RIVGROUP' original mean phi (factor): 1181.1 (0.812245)
...file tag 'HEADDIFFGROUP' adjusted mean phi (factor): 1.45412e-27 (1e-30)
...file tag 'HEADGROUP' adjusted mean phi (factor): 1163.3 (0.8)
...file tag 'RIVGROUP' adjusted mean phi (factor): 290.824 (0.2)
...saved adjusted weight ensemble to  at.adjusted.weights.csv
saved par and rei files for realization BASE for iteration 0
saved par and rei files for realization BASE

  ---  initial phi summary  ---  
       phi type           mean            std            min            max
       measured        1454.12        2683.21        172.145        17931.4
         actual        1305.07        2622.14        73.3318        17464.9
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0  1.02e+03  2.67e+03      72.9  1.75e+04        65      29.6
rivgroup            2          0       287       370      0.39   1.5e+03        35      29.6
headdiffgroup       3          3  1.45e-27  5.91e-28  8.65e-28   4.2e-27  2.74e-28  2.83e-28

...current lambda: 10

  ---  initialization complete  ---  

  ---  starting solve for iteration: 1  ---  
...current lambda:  10
...starting calcs for glm factor 1
...finished calcs for: 1
...starting calcs for glm factor 10
...finished calcs for: 10
...starting calcs for glm factor 100
...finished calcs for: 100

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:0, 6:8, 11:13, 45:BASE, 
...subset idx:oe real name:  0:0, 6:8, 11:13, 45:BASE, 
    running model 36 times
    starting at 07/18/25 11:02:20
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:02:21 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:22 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:23 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:24 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:25 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:26 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:27 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:28 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:29 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:30 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:31 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:32 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:33 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:34 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:35 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:36 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:37 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:02:38 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:02:39 mn:0.14  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:02:40 mn:0.14  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:02:40 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.123 avg run time (min) : 0.338 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  1454.12
...last stdev:  2683.21

  ---  phi summary for best lambda, scale fac: 1 , 1.1 ,   ---  
       phi type           mean            std            min            max
       measured        132.073         90.865        18.9942        238.145
         actual        77.7391        57.1897        18.9942         153.07
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.

  ---  running remaining realizations for best lambda, scale:1 , 1.1 ,   ---  
    running model 42 times
    starting at 07/18/25 11:02:40
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:02:41 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:42 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:43 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:44 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:45 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:46 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:47 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:48 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:49 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:50 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:51 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:52 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:53 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:54 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:55 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:56 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:02:57 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:02:58 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:02:59 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:03:00 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:03:01 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:03:02 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:03:03 mn:0.14  runs(C31   |F0    |T0    ) agents(R11  |W4   |U0   ) 0  07/18 11:03:04 remaining file transfers: 0

   42 runs complete :  0 runs failed
   0.129 avg run time (min) : 0.397 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  3  ---  
...dropping par:obs realizations: 31 : 31 , 39 : 39 , 43 : 43 , 
...phi summary for entire ensemble using lambda,scale_fac 1 , 1.1 , 
       phi type           mean            std            min            max
       measured        216.207         83.577        18.9942        401.187
         actual        132.734        90.0551        16.9395        363.018
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
...last best mean phi * acceptable phi factor:  1526.83
...current best mean phi:  216.207

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.75  ---  

  ---  EnsembleMethod iteration 1 report  ---  
   number of active realizations:   43
   number of model runs:            128
      current obs ensemble saved to at.1.obs.csv
      current par ensemble saved to at.1.par.csv
saved par and rei files for realization BASE for iteration 1
saved par and rei files for realization BASE
       phi type           mean            std            min            max
       measured        216.207         83.577        18.9942        401.187
         actual        132.734        90.0551        16.9395        363.018
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0       123      87.5      10.6       348      90.3      9.96
rivgroup            2          0        10      11.1    0.0792      56.4      9.73      9.96
headdiffgroup       3          3  1.28e-27  1.25e-28     1e-27  1.62e-27   1.7e-27  1.62e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1    0.2062    12.17          2      4.651          0          0           0
riverbed          1     2.039    35.11          0          0          0          0           0
pp-k_clay.ref   104      1376    8.991          2    0.04472         18     0.4025           0
pp-k_aq.ref     104      1022    21.93          1    0.02236          0          0           0
cn-k_clay.ref     1     64.52 0.009055          0          0          0          0           0
cn-k_aq.ref       1     32.84    54.88          0          0          0          0           0

...saved parameter change summary to at.1.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1454.12 , 216.207 , 
...best phi yet:  216.207
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 2  ---  
...current lambda:  0.75
...starting calcs for glm factor 0.075
...finished calcs for: 0.075
...starting calcs for glm factor 0.75
...finished calcs for: 0.75
...starting calcs for glm factor 7.5
...finished calcs for: 7.5

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  3:BASE, 5:2, 21:22, 33:35, 
...subset idx:oe real name:  3:BASE, 5:2, 21:22, 33:35, 
    running model 36 times
    starting at 07/18/25 11:03:04
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:03:05 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:06 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:07 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:08 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:09 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:10 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:11 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:12 mn:0.13  runs(C1    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:13 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:14 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:15 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:16 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:17 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:18 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:19 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:20 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:21 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:03:22 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:03:23 mn:0.13  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:03:24 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.121 avg run time (min) : 0.333 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  216.207
...last stdev:  83.577

  ---  phi summary for best lambda, scale fac: 0.075 , 1.1 ,   ---  
       phi type           mean            std            min            max
       measured        89.4901        57.1821        5.15686        127.145
         actual        33.5767        23.4556        5.15686         61.599
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.

  ---  running remaining realizations for best lambda, scale:0.075 , 1.1 ,   ---  
    running model 39 times
    starting at 07/18/25 11:03:24
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:03:25 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:26 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:27 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:28 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:29 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:30 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:31 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:32 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:33 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:34 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:35 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:36 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:37 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:38 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:39 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:40 mn:0.14  runs(C18   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:41 mn:0.14  runs(C30   |F0    |T0    ) agents(R9   |W6   |U0   ) 0  07/18 11:03:42 mn:0.14  runs(C30   |F0    |T0    ) agents(R9   |W6   |U0   ) 0  07/18 11:03:43 mn:0.14  runs(C30   |F0    |T0    ) agents(R9   |W6   |U0   ) 0  07/18 11:03:44 mn:0.13  runs(C32   |F0    |T0    ) agents(R7   |W8   |U0   ) 0  07/18 11:03:45 mn:0.13  runs(C33   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:03:46 remaining file transfers: 0

   39 runs complete :  0 runs failed
   0.12 avg run time (min) : 0.359 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  2  ---  
...dropping par:obs realizations: 19 : 19 , 25 : 25 , 
...phi summary for entire ensemble using lambda,scale_fac 0.075 , 1.1 , 
       phi type           mean            std            min            max
       measured        111.838        31.9017        5.15686        175.731
         actual        45.7972        31.0128        5.15686         144.72
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
...last best mean phi * acceptable phi factor:  227.017
...current best mean phi:  111.838

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.05625  ---  

  ---  EnsembleMethod iteration 2 report  ---  
   number of active realizations:   41
   number of model runs:            203
      current obs ensemble saved to at.2.obs.csv
      current par ensemble saved to at.2.par.csv
saved par and rei files for realization BASE for iteration 2
saved par and rei files for realization BASE
       phi type           mean            std            min            max
       measured        111.838        31.9017        5.15686        175.731
         actual        45.7972        31.0128        5.15686         144.72
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0      43.2      30.9         3       144      92.3         9
rivgroup            2          0      2.63      2.93     0.154      10.8      7.69         9
headdiffgroup       3          3  1.34e-27   8.3e-29  1.08e-27  1.51e-27  4.37e-27  3.85e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1    0.4593    6.017          4      9.756          0          0           0
cn-k_clay.ref     1     572.2    9.218          0          0          1      2.439           0
riverbed          1     2.841    20.96          0          0          0          0           0
pp-k_clay.ref   104      1675    7.295          6     0.1407         29     0.6801           0
pp-k_aq.ref     104      1202    21.44          0          0          3    0.07036           0
cn-k_aq.ref       1     102.1    59.49          0          0          0          0           0

...saved parameter change summary to at.2.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1454.12 , 216.207 , 111.838 , 
...best phi yet:  111.838
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 3  ---  
...current lambda:  0.05625
...starting calcs for glm factor 0.005625
...finished calcs for: 0.005625
...starting calcs for glm factor 0.05625
...finished calcs for: 0.05625
...starting calcs for glm factor 0.5625
...finished calcs for: 0.5625

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:BASE, 11:9, 28:30, 32:36, 
...subset idx:oe real name:  0:BASE, 11:9, 28:30, 32:36, 
    running model 36 times
    starting at 07/18/25 11:03:46
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:03:47 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:48 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:49 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:50 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:51 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:52 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:53 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:54 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:55 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:56 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:57 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:58 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:03:59 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:00 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:01 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:02 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:03 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W4   |U5   ) 0  07/18 11:04:04 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:04:05 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:04:06 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:04:07 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.126 avg run time (min) : 0.346 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  111.838
...last stdev:  31.9017

  ---  phi summary for best lambda, scale fac: 0.005625 , 1.1 ,   ---  
       phi type           mean            std            min            max
       measured        91.1265        62.0017         3.8536        150.278
         actual        39.0408        26.5078         3.8536        65.0957
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.

  ---  running remaining realizations for best lambda, scale:0.005625 , 1.1 ,   ---  
    running model 37 times
    starting at 07/18/25 11:04:07
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:04:08 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:09 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:10 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:11 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:12 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:13 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:14 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:15 mn:0.12  runs(C2    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:16 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:17 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:18 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:19 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:20 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:21 mn:0.13  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:22 mn:0.13  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:23 mn:0.13  runs(C18   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:24 mn:0.13  runs(C30   |F0    |T0    ) agents(R7   |W8   |U0   ) 0  07/18 11:04:25 mn:0.13  runs(C32   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:04:26 mn:0.13  runs(C33   |F0    |T0    ) agents(R4   |W11  |U0   ) 0  07/18 11:04:26 remaining file transfers: 0

   37 runs complete :  0 runs failed
   0.119 avg run time (min) : 0.33 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  1  ---  
...dropping par:obs realizations: 29 : 29 , 
...phi summary for entire ensemble using lambda,scale_fac 0.005625 , 1.1 , 
       phi type           mean            std            min            max
       measured        102.142        29.7076         3.8536        156.968
         actual         51.678        45.5587         3.8536        250.687
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
...last best mean phi * acceptable phi factor:  117.43
...current best mean phi:  102.142

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.00421875  ---  

  ---  EnsembleMethod iteration 3 report  ---  
   number of active realizations:   40
   number of model runs:            276
      current obs ensemble saved to at.3.obs.csv
      current par ensemble saved to at.3.par.csv
saved par and rei files for realization BASE for iteration 3
saved par and rei files for realization BASE
       phi type           mean            std            min            max
       measured        102.142        29.7076         3.8536        156.968
         actual         51.678        45.5587         3.8536        250.687
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0      49.2      45.2      2.37       250      93.6      6.95
rivgroup            2          0      2.53      2.68     0.156      11.1      6.37      6.95
headdiffgroup       3          3  1.35e-27  9.02e-29  1.09e-27  1.54e-27  4.44e-27  5.23e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1    0.2905    22.16          3        7.5          0          0           0
pp-k_clay.ref   104      1673    24.16         37     0.8894         99       2.38           0
cn-k_clay.ref     1     691.5    1.017          0          0          1        2.5           0
pp-k_aq.ref     104      1324    18.11         19     0.4567         32     0.7692           0
riverbed          1     3.622    4.959          0          0          0          0           0
cn-k_aq.ref       1     59.93    61.05          0          0          0          0           0

...saved parameter change summary to at.3.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1454.12 , 216.207 , 111.838 , 102.142 , 
...best phi yet:  102.142
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 4  ---  
...current lambda:  0.00421875
...starting calcs for glm factor 0.000421875
...finished calcs for: 0.000421875
...starting calcs for glm factor 0.00421875
...finished calcs for: 0.00421875
...starting calcs for glm factor 0.0421875
...finished calcs for: 0.0421875

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:BASE, 15:11, 28:28, 39:48, 
...subset idx:oe real name:  0:BASE, 15:11, 28:28, 39:48, 
    running model 36 times
    starting at 07/18/25 11:04:27
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:04:28 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:29 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:30 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:31 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:32 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:33 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:34 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:35 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:36 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:37 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:38 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:39 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:40 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:41 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:42 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:43 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:44 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W8   |U1   ) 0  07/18 11:04:45 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:04:46 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:04:47 mn:0.13  runs(C34   |F0    |T0    ) agents(R2   |W13  |U0   ) 0  07/18 11:04:47 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.124 avg run time (min) : 0.339 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  102.142
...last stdev:  29.7076

  ---  phi summary for best lambda, scale fac: 0.0421875 , 1.1 ,   ---  
       phi type           mean            std            min            max
       measured        60.0187        41.6373        3.25685        91.8475
         actual        44.7365        30.2741        3.25685        75.6268
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.

  ---  running remaining realizations for best lambda, scale:0.0421875 , 1.1 ,   ---  
    running model 36 times
    starting at 07/18/25 11:04:47
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:04:48 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:49 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:50 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:51 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:52 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:53 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:54 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:55 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:56 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:57 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:58 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:04:59 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:00 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:01 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:02 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:03 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:04 mn:0.14  runs(C24   |F0    |T0    ) agents(R12  |W2   |U1   ) 0  07/18 11:05:05 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:05:06 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:05:07 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:05:08 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.126 avg run time (min) : 0.345 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  2  ---  
...dropping par:obs realizations: 13 : 13 , 1 : 1 , 
...phi summary for entire ensemble using lambda,scale_fac 0.0421875 , 1.1 , 
       phi type           mean            std            min            max
       measured         106.45        35.8464        3.25685        184.812
         actual        63.3884        46.9602        3.25685        252.155
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
...last best mean phi * acceptable phi factor:  107.249
...current best mean phi:  106.45

  ---  updating parameter ensemble  ---  

  ---  not updating lambda (standard deviation reduction criteria not met)  ---  

  ---  EnsembleMethod iteration 4 report  ---  
   number of active realizations:   38
   number of model runs:            348
      current obs ensemble saved to at.4.obs.csv
      current par ensemble saved to at.4.par.csv
saved par and rei files for realization BASE for iteration 4
saved par and rei files for realization BASE
       phi type           mean            std            min            max
       measured         106.45        35.8464        3.25685        184.812
         actual        63.3884        46.9602        3.25685        252.155
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0      60.5      46.4      2.05       252      94.2      6.78
rivgroup            2          0      2.84      3.18     0.101      12.1      5.75      6.78
headdiffgroup       3          3  1.36e-27  1.03e-28  1.11e-27  1.58e-27  4.02e-27  6.39e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1   0.02641    59.13          8      21.05          2      5.263           0
pp-k_clay.ref   104      1448    54.25        147       3.72        195      4.934           0
pp-k_aq.ref     104      1464    25.67         53      1.341        102      2.581           0
cn-k_clay.ref     1     681.6    15.94          0          0          1      2.632           0
riverbed          1     3.892    24.06          0          0          0          0           0
cn-k_aq.ref       1      29.7    51.55          0          0          0          0           0

...saved parameter change summary to at.4.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1454.12 , 216.207 , 111.838 , 102.142 , 106.45 , 
...best phi yet:  102.142
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  1

  ---  starting solve for iteration: 5  ---  
...current lambda:  0.00421875
...starting calcs for glm factor 0.000421875
...finished calcs for: 0.000421875
...starting calcs for glm factor 0.00421875
...finished calcs for: 0.00421875
...starting calcs for glm factor 0.0421875
...finished calcs for: 0.0421875

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:BASE, 14:7, 16:12, 34:44, 
...subset idx:oe real name:  0:BASE, 14:7, 16:12, 34:44, 
    running model 36 times
    starting at 07/18/25 11:05:08
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:05:09 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:10 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:11 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:12 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:13 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:14 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:15 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:16 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:17 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:18 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:19 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:20 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:21 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:22 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:23 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:24 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:25 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:05:26 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:05:27 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:05:28 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:05:29 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.125 avg run time (min) : 0.343 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  106.45
...last stdev:  35.8464

  ---  best subset mean phi  (121.724) greater than acceptable phi : 111.772  ---  
...updating realizations with reduced phi
...current best mean phi (after updating reduced-phi reals):  106.399

  ---  partial update improved phi stats, updating lambda to  0.0316406  ---  
...returning to upgrade calculations...

  ---  EnsembleMethod iteration 5 report  ---  
   number of active realizations:   38
   number of model runs:            384
      current obs ensemble saved to at.5.obs.csv
      current par ensemble saved to at.5.par.csv
saved par and rei files for realization BASE for iteration 5
saved par and rei files for realization BASE
       phi type           mean            std            min            max
       measured        106.399        35.8046        2.73731        183.408
         actual        63.7726        47.4552        2.73731        252.155
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0      60.9      46.7      1.75       252      94.2       6.7
rivgroup            2          0      2.92       3.4     0.101      12.8      5.77       6.7
headdiffgroup       3          3  1.36e-27  1.03e-28  1.11e-27  1.58e-27  4.23e-27  7.64e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1   0.02554    59.94          8      21.05          2      5.263           0
pp-k_clay.ref   104      1443    54.99        148      3.745        202      5.111           0
pp-k_aq.ref     104      1478    25.88         54      1.366        106      2.682           0
cn-k_clay.ref     1       675    15.08          0          0          1      2.632           0
riverbed          1     3.903    23.88          0          0          0          0           0
cn-k_aq.ref       1      29.5    51.43          0          0          0          0           0

...saved parameter change summary to at.5.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1454.12 , 216.207 , 111.838 , 102.142 , 106.45 , 106.399 , 
...best phi yet:  102.142
...number of consecutive bad lambda testing cycles:  1
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  2
...solution iterations &gt;= noptmax, all done


pestpp-ies analysis complete...
started at 07/18/25 11:01:54
finished at 07/18/25 11:05:29
took 3.56667 minutes</code></pre>
</div>
</div>
<div id="bfdfdcbf-267f-49a1-bb5b-0a0c9001818b" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:05:29.912031Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:05:29.911689Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:05:29.929322Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:05:29.928917Z&quot;}}" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_ies_results(m_d,tag<span class="op">=</span><span class="st">""</span>,noptmax<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    pst <span class="op">=</span> pyemu.Pst(os.path.join(m_d,<span class="st">"at.pst"</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    noise <span class="op">=</span> pst.ies.noise</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    itrs <span class="op">=</span> pst.ies.phiactual.iteration.values</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> noptmax <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        noptmax <span class="op">=</span> itrs.<span class="bu">max</span>()</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    obs <span class="op">=</span> pst.observation_data</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    nzobs <span class="op">=</span> obs.loc[obs.obgnme<span class="op">==</span><span class="st">'headgroup'</span>,:]</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    odict <span class="op">=</span> {n:v <span class="cf">for</span> n,v <span class="kw">in</span> <span class="bu">zip</span>(nzobs.obsnme,nzobs.obsval)}</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ptoe = pst.ies.get("obsen{0}".format(noptmax))</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    ptoe <span class="op">=</span> pst.ies.get(<span class="st">"obsen"</span>,noptmax)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    proe <span class="op">=</span> pst.ies.obsen0</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    phivals <span class="op">=</span> pst.ies.phimeas.iloc[noptmax,<span class="dv">6</span>:]</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    phimean <span class="op">=</span> phivals.mean()</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    phistd <span class="op">=</span> phivals.std()</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    thresh <span class="op">=</span> phimean <span class="op">+</span> (phistd<span class="op">*</span><span class="fl">1.75</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    keep <span class="op">=</span> phivals[phivals<span class="op">&lt;=</span>thresh].index.values</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    ptoe <span class="op">=</span> ptoe.loc[keep]</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    proe <span class="op">=</span> proe.loc[keep]</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    noise <span class="op">=</span> noise.loc[keep]</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    names <span class="op">=</span> obs.loc[obs.obgnme<span class="op">==</span><span class="st">"headgroup"</span>,<span class="st">"obsnme"</span>].values</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> oname <span class="kw">in</span> names:</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"at.csv"</span> <span class="kw">not</span> <span class="kw">in</span> oname:</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>        ovals <span class="op">=</span> [odict[oname] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(noise.shape[<span class="dv">0</span>])]</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>        ax.scatter(ovals,noise[oname],marker<span class="op">=</span><span class="st">'.'</span>,c<span class="op">=</span><span class="st">'r'</span>,s<span class="op">=</span><span class="dv">100</span>,alpha<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>        ovals <span class="op">=</span> [odict[oname] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(ptoe.shape[<span class="dv">0</span>])]</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>        ax.scatter(ovals,ptoe[oname],marker<span class="op">=</span><span class="st">'.'</span>,c<span class="op">=</span><span class="st">'b'</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ylim = ax.get_ylim()</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>        ovals <span class="op">=</span> [odict[oname] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(proe.shape[<span class="dv">0</span>])]</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>        ax.scatter(ovals,proe[oname],marker<span class="op">=</span><span class="st">'.'</span>,c<span class="op">=</span><span class="st">'0.5'</span>,alpha<span class="op">=</span><span class="fl">0.5</span>,zorder<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ax.set_ylim(ylim)</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ax.set_xlim(ylim)</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    mn,mx <span class="op">=</span> noise.loc[:,names].values.<span class="bu">min</span>(),noise.loc[:,names].values.<span class="bu">max</span>()</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    ax.plot([mn,mx],[mn,mx],<span class="st">"k--"</span>,lw<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"obs"</span>)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"sim"</span>)</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(mn,mx)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    ax.set_title(tag)</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> ax.set_ylim(mn,mx)</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>    kobs <span class="op">=</span> obs.loc[obs.obsnme.<span class="bu">str</span>.contains(<span class="st">"k_aq"</span>),:].copy()</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>    kobs[<span class="st">'i'</span>] <span class="op">=</span> kobs.i.astype(<span class="bu">int</span>)</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>    kobs[<span class="st">'j'</span>] <span class="op">=</span> kobs.j.astype(<span class="bu">int</span>)</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>    prarr <span class="op">=</span> np.zeros((kobs.i.<span class="bu">max</span>()<span class="op">+</span><span class="dv">1</span>,kobs.j.<span class="bu">max</span>()<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>    prarr[kobs.i,kobs.j] <span class="op">=</span> np.log10(ptoe.loc[:,kobs.obsnme].mean())</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>    ptarr <span class="op">=</span> np.zeros((kobs.i.<span class="bu">max</span>()<span class="op">+</span><span class="dv">1</span>,kobs.j.<span class="bu">max</span>()<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>    ptarr[kobs.i,kobs.j] <span class="op">=</span> np.log10(ptoe.loc[<span class="st">"base"</span>,kobs.obsnme])</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>    fig,axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    cb <span class="op">=</span> axes[<span class="dv">0</span>].imshow(prarr,vmin<span class="op">=</span>ptarr.<span class="bu">min</span>())</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>    plt.colorbar(cb,ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">"mean "</span><span class="op">+</span>tag)</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>    cb <span class="op">=</span> axes[<span class="dv">1</span>].imshow(ptarr,vmax<span class="op">=</span>prarr.<span class="bu">max</span>())</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>    plt.colorbar(cb,ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">"min err var "</span><span class="op">+</span>tag)</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>    prarr <span class="op">=</span> np.zeros((kobs.i.<span class="bu">max</span>()<span class="op">+</span><span class="dv">1</span>,kobs.j.<span class="bu">max</span>()<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>    prarr[kobs.i,kobs.j] <span class="op">=</span> np.log10(proe.loc[:,kobs.obsnme].std())</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>    ptarr <span class="op">=</span> np.zeros((kobs.i.<span class="bu">max</span>()<span class="op">+</span><span class="dv">1</span>,kobs.j.<span class="bu">max</span>()<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>    ptarr[kobs.i,kobs.j] <span class="op">=</span> np.log10(ptoe.loc[:,kobs.obsnme].std())</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>    fig,axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>    cb <span class="op">=</span> axes[<span class="dv">0</span>].imshow(prarr,vmin<span class="op">=</span>ptarr.<span class="bu">min</span>())</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>    plt.colorbar(cb,ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">"prior stdev "</span><span class="op">+</span>tag)</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>    cb <span class="op">=</span> axes[<span class="dv">1</span>].imshow(ptarr,vmax<span class="op">=</span>prarr.<span class="bu">max</span>())</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>    plt.colorbar(cb,ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">"posterior stdev "</span><span class="op">+</span>tag)</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>    bobs <span class="op">=</span> obs.loc[obs.oname<span class="op">==</span><span class="st">"at.budget.csv"</span>,:]</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> oname <span class="kw">in</span> bobs.obsnme:</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"chd"</span> <span class="kw">not</span> <span class="kw">in</span> oname:</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>        fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>        ax.hist(proe.loc[:,oname],bins<span class="op">=</span><span class="dv">10</span>,fc<span class="op">=</span><span class="st">"0.5"</span>,alpha<span class="op">=</span><span class="fl">0.5</span>,density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>        ax.hist(ptoe.loc[:,oname],bins<span class="op">=</span><span class="dv">10</span>,fc<span class="op">=</span><span class="st">"b"</span>,alpha<span class="op">=</span><span class="fl">0.5</span>,density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>        ax.set_title(tag<span class="op">+</span><span class="st">" "</span><span class="op">+</span>oname)</span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>        ax.set_yticks([])</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>    names <span class="op">=</span> obs.loc[obs.obgnme<span class="op">==</span><span class="st">"headgroup"</span>,<span class="st">"obsnme"</span>].values</span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>    noise <span class="op">=</span> pst.ies.noise</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>    proe <span class="op">=</span> pst.ies.obsen0</span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>    ptoe <span class="op">=</span> pst.ies.get(<span class="st">"obsen</span><span class="sc">{0}</span><span class="st">"</span>.<span class="bu">format</span>(pst.ies.phiactual.iteration.<span class="bu">max</span>()))</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>    phivals <span class="op">=</span> pst.ies.phimeas.iloc[<span class="op">-</span><span class="dv">1</span>,<span class="dv">6</span>:]</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>    phimean <span class="op">=</span> phivals.mean()</span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>    phistd <span class="op">=</span> phivals.std()</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>    thresh <span class="op">=</span> phimean <span class="op">+</span> (phistd<span class="op">*</span><span class="fl">1.75</span>)</span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>    keep <span class="op">=</span> phivals[phivals<span class="op">&lt;=</span>thresh].index.values</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>    fig,axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">20</span>))</span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>    actual,meas <span class="op">=</span> pst.ies.phiactual.iloc[:,<span class="dv">6</span>:],pst.ies.phimeas.iloc[:,<span class="dv">6</span>:]</span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>    actual <span class="op">=</span> actual.loc[:,keep]</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>    meas <span class="op">=</span> meas.loc[:,keep]</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].hist(np.log10(actual.iloc[<span class="dv">0</span>,:].values),fc<span class="op">=</span><span class="st">"0.5"</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].hist(np.log10(actual.iloc[<span class="op">-</span><span class="dv">1</span>,:].values),fc<span class="op">=</span><span class="st">"b"</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'log-10 phi w/o noise'</span>)</span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].hist(np.log10(meas.iloc[<span class="dv">0</span>,:].values),fc<span class="op">=</span><span class="st">"0.5"</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].hist(np.log10(meas.iloc[<span class="op">-</span><span class="dv">1</span>,:].values),fc<span class="op">=</span><span class="st">"b"</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'log-10 phi w/ noise'</span>)</span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>    fig,axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">20</span>))</span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>    nzobs <span class="op">=</span> nzobs.loc[nzobs.obgnme<span class="op">==</span><span class="st">"headgroup"</span>,:]</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(nzobs)</span></span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a>    ptoe <span class="op">=</span> ptoe.loc[keep,:]</span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>    nzobs.sort_values(by<span class="op">=</span><span class="st">"obsval"</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>    ovals <span class="op">=</span> nzobs.obsval.values</span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> real <span class="kw">in</span> ptoe.index:</span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>        nvals <span class="op">=</span> noise.loc[real,nzobs.obsnme].values   </span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>        prvals <span class="op">=</span> proe.loc[real,nzobs.obsnme].values</span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a>        ptvals <span class="op">=</span> ptoe.loc[real,nzobs.obsnme].values</span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ax.plot(ovals,nvals,"r-",alpha=0.5,lw=0.5)</span></span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a>        ax.scatter(ovals,nvals,marker<span class="op">=</span><span class="st">'.'</span>,alpha<span class="op">=</span><span class="fl">0.2</span>,s<span class="op">=</span><span class="dv">70</span>,c<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ax.plot(ovals,prvals,"0.5",alpha=0.2,lw=0.3,dashes=(1,1))</span></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ax.plot(ovals,ptvals,"b",alpha=0.5,lw=0.5)#,marker='.',ms=5)</span></span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a>        ax.scatter(ovals,ptvals,marker<span class="op">=</span><span class="st">'.'</span>,s<span class="op">=</span><span class="dv">50</span>,c<span class="op">=</span><span class="st">'b'</span>)</span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a>        ax.plot(ovals,nvals,<span class="st">"r-"</span>,alpha<span class="op">=</span><span class="fl">0.5</span>,lw<span class="op">=</span><span class="fl">0.5</span>,zorder<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a>        ax.scatter(ovals,nvals,marker<span class="op">=</span><span class="st">'.'</span>,alpha<span class="op">=</span><span class="fl">0.2</span>,s<span class="op">=</span><span class="dv">70</span>,c<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ax.plot(ovals,prvals,"0.5",alpha=0.2,lw=0.3,dashes=(1,1))</span></span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ax.plot(ovals,ptvals,"b",alpha=0.5,lw=0.5,zorder=0)#,marker='.',ms=5)</span></span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a>        ax.scatter(ovals,ptvals,marker<span class="op">=</span><span class="st">'.'</span>,s<span class="op">=</span><span class="dv">50</span>,c<span class="op">=</span><span class="st">'b'</span>)</span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a>    mn,mx <span class="op">=</span> noise.loc[:,names].values.<span class="bu">min</span>(),noise.loc[:,names].values.<span class="bu">max</span>()</span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ax <span class="kw">in</span> axes:</span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a>        ax.plot([mn,mx],[mn,mx],<span class="st">"k--"</span>,lw<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">"observed"</span>)</span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">"simulated"</span>)</span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a>        ax.set_xlim(mn,mx)</span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>        ax.grid()</span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> ax.set_ylim(mn,mx)</span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="e0c8cbb6-cfa3-44cf-ab10-5729eb9087d9" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:05:29.930758Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:05:29.930605Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:05:32.803167Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:05:32.802687Z&quot;}}" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plot_ies_results(m_d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-18-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-18-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-18-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-18-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-18-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-18-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="124ecb62-d834-4e5d-8d02-7ffe5ca18aea" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:05:32.804957Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:05:32.804797Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:09:25.136191Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:09:25.135614Z&quot;}}" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pst.pestpp_options[<span class="st">"ies_no_noise"</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>pst.write(os.path.join(t_d,<span class="st">"at.pst"</span>),version<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>m_d <span class="op">=</span> <span class="st">"master_ies_nonoise"</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>pyemu.os_utils.start_workers(t_d,<span class="st">"pestpp-ies"</span>,<span class="st">"at.pst"</span>,num_workers<span class="op">=</span><span class="dv">15</span>,master_dir<span class="op">=</span>m_d,worker_root<span class="op">=</span><span class="st">'.'</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plot_ies_results(m_d,<span class="st">"no noise"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>noptmax:5, npar_adj:212, nnz_obs:36


             pestpp-ies: a GLM iterative ensemble smoother

                   by the PEST++ development team


version: 5.2.21
binary compiled on Jul 14 2025 at 14:36:32

started at 07/18/25 11:05:32
...processing command line: ' ./pestpp-ies at.pst /h :4004'
...using panther run manager in master mode using port 4004

using control file: "at.pst"
in directory: "/home/runner/work/PESTPP_Madison25/PESTPP_Madison25/notebooks/master_ies_nonoise"
on host: "pkrvmq0rgcvqdmg"

processing control file at.pst


:~-._                                                 _.-~:
: :.~^o._        ________---------________        _.o^~.:.:
 : ::.`?88booo~~~.::::::::...::::::::::::..~~oood88P'.::.:
 :  ::: `?88P .:::....         ........:::::. ?88P' :::. :
  :  :::. `? .::.            . ...........:::. P' .:::. :
   :  :::   ... ..  ...       .. .::::......::.   :::. :
   `  :' .... ..  .:::::.     . ..:::::::....:::.  `: .'
    :..    ____:::::::::.  . . ....:::::::::____  ... :
   :... `:~    ^~-:::::..  .........:::::-~^    ~::.::::
   `.::. `\   (8)  \b:::..::.:.:::::::d/  (8)   /'.::::'
    ::::.  ~-._v    |b.::::::::::::::d|    v_.-~..:::::
    `.:::::... ~~^?888b..:::::::::::d888P^~...::::::::'
     `.::::::::::....~~~ .:::::::::~~~:::::::::::::::'
      `..:::::::::::   .   ....::::    ::::::::::::,'
        `. .:::::::    .      .::::.    ::::::::'.'
          `._ .:::    .        :::::.    :::::_.'
             `-. :    .        :::::      :,-'
                :.   :___     .:::___   .::
      ..--~~~~--:+::. ~~^?b..:::dP^~~.::++:--~~~~--..
        ___....--`+:::.    `~8~'    .:::+'--....___
      ~~   __..---`_=:: ___gd8bg___ :==_'---..__   ~~
       -~~~  _.--~~`-.~~~~~~~~~~~~~~~,-' ~~--._ ~~~-


               starting PANTHER master...

IP addresses:
  0.0.0.0:4004 (IPv4)

PANTHER master listening on socket: 0.0.0.0:4004 (IPv4)

  ---  initializing  ---  
...checking phi factors in file phi_factors.csv
...using glm algorithm
...using REDSVD for truncated svd solve
...maxsing: 10000000
...eigthresh:  1e-06
...initializing localizer
...not using localization
...using lambda multipliers: 0.1 , 1 , 10 , 
...using lambda scaling factors: 0.75 , 1 , 1.1 , 
...acceptable phi factor:  1.05
...lambda increase factor:  10
...lambda decrease factor:  0.75
...max run fail:  1
...initializing prior parameter covariance matrix
...parcov loaded  from parameter bounds, using par_sigma_range 4
...initializing observation noise covariance matrix
...obscov loaded  from observation weights
...using reg_factor:  0
...loading par ensemble from csv file prior.csv
...ies_num_reals arg passed, truncated parameter ensemble to  50
...not using prior parameter covariance matrix scaling
...initializing no-noise observation ensemble of :  50
...setting weights ensemble from control file weights
...saved weight ensemble to  at.weights.csv
...adding 'base' parameter values to ensemble
...adding 'base' observation values to ensemble
...adding 'base' weight values to weight ensemble
...saved initial parameter ensemble to  at.0.par.csv
...saved obs+noise observation ensemble (obsval + noise realizations) to  at.obs+noise.csv
...using subset in lambda testing, percentage of realizations used in subset testing:  10
...subset how:  RANDOM
...centering on ensemble mean vector
...running initial ensemble of size 50
    running model 50 times
    starting at 07/18/25 11:05:33

    waiting for agents to appear...


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:05:34 mn:0     runs(C0    |F0    |T0    ) agents(R6   |W0   |U5   ) 0  07/18 11:05:35 mn:0     runs(C0    |F0    |T0    ) agents(R13  |W0   |U2   ) 0  07/18 11:05:36 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:37 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:38 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:39 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:40 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:41 mn:0.12  runs(C1    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:42 mn:0.13  runs(C13   |F0    |T0    ) agents(R13  |W1   |U1   ) 0  07/18 11:05:43 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:44 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:45 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:46 mn:0.12  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:47 mn:0.12  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:48 mn:0.12  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:49 mn:0.12  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:50 mn:0.12  runs(C30   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:51 mn:0.12  runs(C32   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:52 mn:0.12  runs(C32   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:53 mn:0.12  runs(C32   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:54 mn:0.12  runs(C32   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:55 mn:0.12  runs(C32   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:56 mn:0.12  runs(C33   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:05:57 mn:0.12  runs(C37   |F0    |T0    ) agents(R13  |W1   |U1   ) 0  07/18 11:05:58 mn:0.12  runs(C47   |F0    |T0    ) agents(R3   |W12  |U0   ) 0  07/18 11:05:59 mn:0.12  runs(C49   |F0    |T0    ) agents(R1   |W14  |U0   ) 0  07/18 11:05:59 remaining file transfers: 0

   50 runs complete :  0 runs failed
   0.115 avg run time (min) : 0.438 run mgr time (min)
   15 agents connected


...saved initial obs ensemble to at.0.obs.csv
saved par and rei files for realization BASE for iteration 0
saved par and rei files for realization BASE

  ---  pre-drop initial phi summary  ---  
       phi type           mean            std            min            max
         actual        2200.44        3226.06        18.7208        16422.3
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
rivgroup            2          0  1.24e+03  1.77e+03      1.58   8.1e+03      68.1      36.5
headgroup          31          0       965  3.07e+03      17.1  1.64e+04      31.9      36.5
headdiffgroup       3          3    0.0298    0.0231    0.0148     0.134   0.00654    0.0163

...checking for prior-data conflict

  ---  WARNING: 3 non-zero weighted observations are in conflict with the prior simulated ensemble.
  ---  
...see at.0.pdc.csv for listing of conflicted observations

...  WARNING: Prior-data conflict detected.  Continuing with IES parameter
           adjustment will likely result in parameter and forecast bias.


  ---  dropping realizations as bad:  4  ---  
...dropping par:obs realizations: 3 : 3 , 6 : 6 , 37 : 37 , 42 : 42 , 

  ---  adjusting weights using phi factors in file phi_factors.csv  ---  

  ---  pre-weight-adjustment initial phi summary  ---  
       phi type           mean            std            min            max
         actual        1403.84        1511.19        18.7208        6162.19
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
rivgroup            2          0  1.16e+03   1.5e+03      1.58  6.09e+03      71.9      33.3
headgroup          31          0       239       627      17.1   4.1e+03      28.1      33.3
headdiffgroup       3          3    0.0249    0.0101    0.0148    0.0719   0.00704    0.0169

...checking phi factors in file phi_factors.csv
...using mean residuals for reweighting
...original mean phi:  1403.84
...file tag 'HEADDIFFGROUP' original mean phi (factor): 0.0248655 (1.77124e-05)
...file tag 'HEADGROUP' original mean phi (factor): 238.953 (0.170214)
...file tag 'RIVGROUP' original mean phi (factor): 1164.87 (0.829769)
...file tag 'HEADDIFFGROUP' adjusted mean phi (factor): 1.40384e-27 (1e-30)
...file tag 'HEADGROUP' adjusted mean phi (factor): 1123.07 (0.8)
...file tag 'RIVGROUP' adjusted mean phi (factor): 280.769 (0.2)
...saved adjusted weight ensemble to  at.adjusted.weights.csv
saved par and rei files for realization BASE for iteration 0
saved par and rei files for realization BASE

  ---  initial phi summary  ---  
       phi type           mean            std            min            max
         actual        1403.84         2895.2        80.8334        19262.4
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0  1.12e+03  2.94e+03      80.5  1.93e+04      66.7      28.9
rivgroup            2          0       281       363     0.381  1.47e+03      33.3      28.9
headdiffgroup       3          3   1.4e-27  5.71e-28  8.35e-28  4.06e-27  2.48e-28  2.51e-28

...current lambda: 10

  ---  initialization complete  ---  

  ---  starting solve for iteration: 1  ---  
...current lambda:  10
...starting calcs for glm factor 1
...finished calcs for: 1
...starting calcs for glm factor 10
...finished calcs for: 10
...starting calcs for glm factor 100
...finished calcs for: 100

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:0, 6:8, 11:13, 45:BASE, 
...subset idx:oe real name:  0:0, 6:8, 11:13, 45:BASE, 
    running model 36 times
    starting at 07/18/25 11:05:59
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:06:00 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:01 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:02 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:03 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:04 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:05 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:06 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:07 mn:0.13  runs(C3    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:08 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:09 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:10 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:11 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:12 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:13 mn:0.14  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:14 mn:0.14  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:15 mn:0.14  runs(C18   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:16 mn:0.13  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:06:17 mn:0.13  runs(C32   |F0    |T0    ) agents(R4   |W11  |U0   ) 0  07/18 11:06:18 mn:0.13  runs(C33   |F0    |T0    ) agents(R3   |W12  |U0   ) 0  07/18 11:06:19 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.121 avg run time (min) : 0.323 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  1403.84
...last stdev:  2895.2

  ---  phi summary for best lambda, scale fac: 1 , 1.1 ,   ---  
       phi type           mean            std            min            max
         actual        77.0813        53.8589        19.0293         138.23

  ---  running remaining realizations for best lambda, scale:1 , 1.1 ,   ---  
    running model 42 times
    starting at 07/18/25 11:06:19
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:06:20 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:21 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:22 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:23 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:24 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:25 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:26 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:27 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:28 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:29 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:30 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:31 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:32 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:33 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:34 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:35 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:36 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:06:37 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:06:38 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:06:39 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:06:40 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:06:41 mn:0.14  runs(C31   |F0    |T0    ) agents(R11  |W4   |U0   ) 0  07/18 11:06:42 mn:0.13  runs(C34   |F0    |T0    ) agents(R8   |W6   |U1   ) 0  07/18 11:06:42 remaining file transfers: 0

   42 runs complete :  0 runs failed
   0.126 avg run time (min) : 0.389 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  3  ---  
...dropping par:obs realizations: 2 : 2 , 31 : 31 , 39 : 39 , 
...phi summary for entire ensemble using lambda,scale_fac 1 , 1.1 , 
       phi type           mean            std            min            max
         actual        91.5896        57.6737        17.6168        226.547
...last best mean phi * acceptable phi factor:  1474.04
...current best mean phi:  91.5896

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.75  ---  

  ---  EnsembleMethod iteration 1 report  ---  
   number of active realizations:   43
   number of model runs:            128
      current obs ensemble saved to at.1.obs.csv
      current par ensemble saved to at.1.par.csv
saved par and rei files for realization BASE for iteration 1
saved par and rei files for realization BASE
       phi type           mean            std            min            max
         actual        91.5896        57.6737        17.6168        226.547
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0      83.3      57.9      9.33       222      86.4      11.3
rivgroup            2          1      8.26      5.05    0.0141      21.4      13.6      11.3
headdiffgroup       3          3  1.23e-27   7.3e-29  1.09e-27  1.42e-27  2.21e-27  1.76e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1     0.113    15.54          1      2.326          0          0           0
riverbed          1     2.157    47.43          0          0          0          0           0
pp-k_clay.ref   104      1272    15.67          1    0.02236          4    0.08945           0
pp-k_aq.ref     104      1133    30.21          1    0.02236          1    0.02236           0
cn-k_clay.ref     1     87.84    5.195          0          0          0          0           0
cn-k_aq.ref       1     65.99     61.5          0          0          0          0           0

...saved parameter change summary to at.1.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1403.84 , 91.5896 , 
...best phi yet:  91.5896
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 2  ---  
...current lambda:  0.75
...starting calcs for glm factor 0.075
...finished calcs for: 0.075
...starting calcs for glm factor 0.75
...finished calcs for: 0.75
...starting calcs for glm factor 7.5
...finished calcs for: 7.5

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  3:BASE, 5:4, 21:23, 33:36, 
...subset idx:oe real name:  3:BASE, 5:4, 21:23, 33:36, 
    running model 36 times
    starting at 07/18/25 11:06:42
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:06:43 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:44 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:45 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:46 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:47 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:48 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:49 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:50 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:51 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:52 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:53 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:54 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:55 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:56 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:57 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:06:58 mn:0.14  runs(C18   |F0    |T0    ) agents(R13  |W1   |U1   ) 0  07/18 11:06:59 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:07:00 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:07:01 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:07:02 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.122 avg run time (min) : 0.333 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  91.5896
...last stdev:  57.6737

  ---  phi summary for best lambda, scale fac: 0.075 , 1.1 ,   ---  
       phi type           mean            std            min            max
         actual        9.86791        3.16881        5.59325        12.4176

  ---  running remaining realizations for best lambda, scale:0.075 , 1.1 ,   ---  
    running model 39 times
    starting at 07/18/25 11:07:02
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:07:03 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:04 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:05 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:06 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:07 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:08 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:09 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:10 mn:0.12  runs(C3    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:11 mn:0.13  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:12 mn:0.13  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:13 mn:0.13  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:14 mn:0.13  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:15 mn:0.13  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:16 mn:0.13  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:17 mn:0.13  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:18 mn:0.13  runs(C19   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:19 mn:0.13  runs(C31   |F0    |T0    ) agents(R8   |W7   |U0   ) 0  07/18 11:07:20 mn:0.13  runs(C32   |F0    |T0    ) agents(R7   |W8   |U0   ) 0  07/18 11:07:21 mn:0.13  runs(C32   |F0    |T0    ) agents(R7   |W8   |U0   ) 0  07/18 11:07:22 mn:0.13  runs(C33   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:07:23 remaining file transfers: 0

   39 runs complete :  0 runs failed
   0.116 avg run time (min) : 0.344 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  3  ---  
...dropping par:obs realizations: 11 : 11 , 25 : 25 , 47 : 47 , 
...phi summary for entire ensemble using lambda,scale_fac 0.075 , 1.1 , 
       phi type           mean            std            min            max
         actual        9.29539        2.38453        5.46119        13.5586
...last best mean phi * acceptable phi factor:  96.169
...current best mean phi:  9.29539

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.05625  ---  

  ---  EnsembleMethod iteration 2 report  ---  
   number of active realizations:   40
   number of model runs:            203
      current obs ensemble saved to at.2.obs.csv
      current par ensemble saved to at.2.par.csv
saved par and rei files for realization BASE for iteration 2
saved par and rei files for realization BASE
       phi type           mean            std            min            max
         actual        9.29539        2.38453        5.46119        13.5586
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          3      6.84      2.43      2.71      12.6      72.6      12.7
rivgroup            2          1      2.46      1.12     0.153      4.68      27.4      12.7
headdiffgroup       3          3  1.28e-27  2.51e-29  1.23e-27  1.37e-27  1.47e-26  3.92e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1    0.3531    30.97          1        2.5          0          0           0
riverbed          1     3.178    54.95          0          0          0          0           0
pp-k_clay.ref   104      1577    26.79          0          0          0          0           0
pp-k_aq.ref     104       962    42.97          0          0          0          0           0
cn-k_clay.ref     1     457.4    30.09          0          0          0          0           0
cn-k_aq.ref       1       103     67.9          0          0          0          0           0

...saved parameter change summary to at.2.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1403.84 , 91.5896 , 9.29539 , 
...best phi yet:  9.29539
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 3  ---  
...current lambda:  0.05625
...starting calcs for glm factor 0.005625
...finished calcs for: 0.005625
...starting calcs for glm factor 0.05625
...finished calcs for: 0.05625
...starting calcs for glm factor 0.5625
...finished calcs for: 0.5625

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:BASE, 11:10, 27:30, 32:38, 
...subset idx:oe real name:  0:BASE, 11:10, 27:30, 32:38, 
    running model 36 times
    starting at 07/18/25 11:07:23
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:07:24 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:25 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:26 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:27 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:28 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:29 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:30 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:31 mn:0.13  runs(C2    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:32 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:33 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:34 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:35 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:36 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:37 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:38 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:39 mn:0.14  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:40 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:07:41 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:07:42 mn:0.13  runs(C32   |F0    |T0    ) agents(R4   |W11  |U0   ) 0  07/18 11:07:43 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.12 avg run time (min) : 0.33 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  9.29539
...last stdev:  2.38453

  ---  phi summary for best lambda, scale fac: 0.005625 , 1.1 ,   ---  
       phi type           mean            std            min            max
         actual        5.51696        1.24032        4.51243        7.17706

  ---  running remaining realizations for best lambda, scale:0.005625 , 1.1 ,   ---  
    running model 36 times
    starting at 07/18/25 11:07:43
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:07:44 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:45 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:46 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:47 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:48 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:49 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:50 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:51 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:52 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:53 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:54 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:55 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:56 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:57 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:58 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:07:59 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:00 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:08:01 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:08:02 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:08:03 mn:0.14  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:08:03 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.123 avg run time (min) : 0.338 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  3  ---  
...dropping par:obs realizations: 21 : 21 , 22 : 22 , 26 : 26 , 
...phi summary for entire ensemble using lambda,scale_fac 0.005625 , 1.1 , 
       phi type           mean            std            min            max
         actual        6.29086        1.00876        4.11885        8.24844
...last best mean phi * acceptable phi factor:  9.76016
...current best mean phi:  6.29086

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.00421875  ---  

  ---  EnsembleMethod iteration 3 report  ---  
   number of active realizations:   37
   number of model runs:            275
      current obs ensemble saved to at.3.obs.csv
      current par ensemble saved to at.3.par.csv
saved par and rei files for realization BASE for iteration 3
saved par and rei files for realization BASE
       phi type           mean            std            min            max
         actual        6.29086        1.00876        4.11885        8.24844
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          4      4.52      1.08      2.33      6.54      71.7      11.8
rivgroup            2          1      1.77     0.733      0.14      3.07      28.3      11.8
headdiffgroup       3          3  1.28e-27  1.71e-29  1.25e-27  1.34e-27  2.09e-26  3.63e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1    0.2261    34.86          1      2.703          0          0           0
riverbed          1     3.322    57.66          0          0          0          0           0
pp-k_clay.ref   104      1534    30.83          0          0          0          0           0
pp-k_aq.ref     104      1021    47.01          0          0          0          0           0
cn-k_clay.ref     1       561     36.8          0          0          0          0           0
cn-k_aq.ref       1     133.8    70.94          0          0          0          0           0

...saved parameter change summary to at.3.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1403.84 , 91.5896 , 9.29539 , 6.29086 , 
...best phi yet:  6.29086
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 4  ---  
...current lambda:  0.00421875
...starting calcs for glm factor 0.000421875
...finished calcs for: 0.000421875
...starting calcs for glm factor 0.00421875
...finished calcs for: 0.00421875
...starting calcs for glm factor 0.0421875
...finished calcs for: 0.0421875

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:BASE, 14:12, 26:32, 36:48, 
...subset idx:oe real name:  0:BASE, 14:12, 26:32, 36:48, 
    running model 36 times
    starting at 07/18/25 11:08:03
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:08:04 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:05 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:06 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:07 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:08 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:09 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:10 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:11 mn:0.13  runs(C1    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:12 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:13 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:14 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:15 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:16 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:17 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:18 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:19 mn:0.14  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:20 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:08:21 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:08:22 mn:0.13  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:08:23 mn:0.13  runs(C34   |F0    |T0    ) agents(R2   |W13  |U0   ) 0  07/18 11:08:23 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.122 avg run time (min) : 0.335 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  6.29086
...last stdev:  1.00876

  ---  phi summary for best lambda, scale fac: 0.000421875 , 1.1 ,   ---  
       phi type           mean            std            min            max
         actual        5.38639       0.934972        4.11739        6.12578

  ---  running remaining realizations for best lambda, scale:0.000421875 , 1.1 ,   ---  
    running model 33 times
    starting at 07/18/25 11:08:23
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:08:24 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:25 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:26 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:27 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:28 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:29 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:30 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:31 mn:0.13  runs(C1    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:32 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:33 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:34 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:35 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:36 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:37 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:38 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:39 mn:0.14  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:40 mn:0.14  runs(C30   |F0    |T0    ) agents(R3   |W12  |U0   ) 0  07/18 11:08:41 mn:0.13  runs(C31   |F0    |T0    ) agents(R2   |W13  |U0   ) 0  07/18 11:08:42 remaining file transfers: 0

   33 runs complete :  0 runs failed
   0.127 avg run time (min) : 0.312 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  1  ---  
...dropping par:obs realizations: 8 : 8 , 
...phi summary for entire ensemble using lambda,scale_fac 0.000421875 , 1.1 , 
       phi type           mean            std            min            max
         actual        5.48113       0.794813        3.79088        6.93695
...last best mean phi * acceptable phi factor:  6.60541
...current best mean phi:  5.48113

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.000316406  ---  

  ---  EnsembleMethod iteration 4 report  ---  
   number of active realizations:   36
   number of model runs:            344
      current obs ensemble saved to at.4.obs.csv
      current par ensemble saved to at.4.par.csv
saved par and rei files for realization BASE for iteration 4
saved par and rei files for realization BASE
       phi type           mean            std            min            max
         actual        5.48113       0.794813        3.79088        6.93695
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          4      3.94      0.85      2.24      5.53      71.7        11
rivgroup            2          1      1.54     0.608     0.163      2.69      28.3        11
headdiffgroup       3          3  1.28e-27  1.59e-29  1.25e-27  1.33e-27  2.39e-26  3.69e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1    0.1768    37.89          1      2.778          0          0           0
riverbed          1     3.626    58.77          0          0          0          0           0
pp-k_clay.ref   104      1562    32.72          0          0          0          0           0
pp-k_aq.ref     104      1074    48.65          0          0          0          0           0
cn-k_clay.ref     1     566.7    37.88          0          0          0          0           0
cn-k_aq.ref       1     145.2     71.4          0          0          0          0           0

...saved parameter change summary to at.4.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1403.84 , 91.5896 , 9.29539 , 6.29086 , 5.48113 , 
...best phi yet:  5.48113
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 5  ---  
...current lambda:  0.000316406
...starting calcs for glm factor 3.16406e-05
...finished calcs for: 3.16406e-05
...starting calcs for glm factor 0.000316406
...finished calcs for: 0.000316406
...starting calcs for glm factor 0.00316406
...finished calcs for: 0.00316406

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:BASE, 13:5, 15:9, 33:44, 
...subset idx:oe real name:  0:BASE, 13:5, 15:9, 33:44, 
    running model 36 times
    starting at 07/18/25 11:08:42
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:08:43 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:44 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:45 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:46 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:47 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:48 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:49 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:50 mn:0.13  runs(C1    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:51 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:52 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:53 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:54 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:55 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:56 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:57 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:58 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:08:59 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:09:00 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:09:01 mn:0.13  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:09:02 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.121 avg run time (min) : 0.333 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  5.48113
...last stdev:  0.794813

  ---  phi summary for best lambda, scale fac: 3.16406e-05 , 1.1 ,   ---  
       phi type           mean            std            min            max
         actual        4.79514       0.825713        3.86273        5.55169

  ---  running remaining realizations for best lambda, scale:3.16406e-05 , 1.1 ,   ---  
    running model 32 times
    starting at 07/18/25 11:09:02
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:09:03 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:04 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:05 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:06 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:07 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:08 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:09 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:10 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:11 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:12 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:13 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:14 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:15 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:16 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:17 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:18 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:19 mn:0.14  runs(C30   |F0    |T0    ) agents(R2   |W13  |U0   ) 0  07/18 11:09:20 mn:0.14  runs(C30   |F0    |T0    ) agents(R2   |W13  |U0   ) 0  07/18 11:09:21 remaining file transfers: 0

   32 runs complete :  0 runs failed
   0.132 avg run time (min) : 0.312 run mgr time (min)
   15 agents connected


...phi summary for entire ensemble using lambda,scale_fac 3.16406e-05 , 1.1 , 
       phi type           mean            std            min            max
         actual        4.98477       0.680936        3.61531        6.07216
...last best mean phi * acceptable phi factor:  5.75519
...current best mean phi:  4.98477

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  2.37305e-05  ---  

  ---  EnsembleMethod iteration 5 report  ---  
   number of active realizations:   36
   number of model runs:            412
      current obs ensemble saved to at.5.obs.csv
      current par ensemble saved to at.5.par.csv
saved par and rei files for realization BASE for iteration 5
saved par and rei files for realization BASE
       phi type           mean            std            min            max
         actual        4.98477       0.680936        3.61531        6.07216
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          4      3.59     0.718      2.19      4.89      71.9      10.3
rivgroup            2          1       1.4     0.523     0.182      2.41      28.1      10.3
headdiffgroup       3          3  1.28e-27   1.5e-29  1.25e-27  1.33e-27  2.62e-26  3.79e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1    0.1729     39.7          1      2.778          0          0           0
riverbed          1     3.925    60.25          0          0          0          0           0
pp-k_clay.ref   104      1595    34.34          0          0          0          0           0
pp-k_aq.ref     104      1126    50.05          0          0          0          0           0
cn-k_clay.ref     1     563.2    39.05          0          0          0          0           0
cn-k_aq.ref       1     152.8    71.94          0          0          0          0           0

...saved parameter change summary to at.5.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1403.84 , 91.5896 , 9.29539 , 6.29086 , 5.48113 , 4.98477 , 
...best phi yet:  4.98477
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0
...solution iterations &gt;= noptmax, all done


pestpp-ies analysis complete...
started at 07/18/25 11:05:32
finished at 07/18/25 11:09:21
took 3.8 minutes</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-19-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-19-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-19-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-19-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-19-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-19-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-19-output-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="46594458-e09c-438e-adac-bdeb4f8193f6" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:09:25.137854Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:09:25.137675Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:09:25.143230Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:09:25.142728Z&quot;}}" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> pst.observation_data</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>hobs <span class="op">=</span> obs.loc[(obs.weight<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">&amp;</span> (obs.obgnme<span class="op">==</span><span class="st">"headgroup"</span>),:]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>hobs.obsnme.tolist()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(hobs) <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>std <span class="op">=</span> hobs.standard_deviation.<span class="bu">max</span>()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>std</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>1.0</code></pre>
</div>
</div>
<div id="0847e0b1-f414-4e3a-9d1c-dbe324dca536" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:09:25.144705Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:09:25.144539Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:09:25.441322Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:09:25.440848Z&quot;}}" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>offsets <span class="op">=</span> np.random.normal(<span class="fl">0.0</span>,std,pst.ies.noise.shape[<span class="dv">0</span>])</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>plt.hist(offsets)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>offsets.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/home/runner/work/PESTPP_Madison25/PESTPP_Madison25/dependencies/pyemu/pyemu/pst/result_handler.py:79: DtypeWarning: Columns (0) have mixed types. Specify dtype option on import or set low_memory=False.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-21-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="56873d25-76e1-44ac-97e7-e6b60f0d9c9c" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:09:25.442987Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:09:25.442669Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:09:26.983599Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:09:26.983027Z&quot;}}" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ovals <span class="op">=</span> obs.loc[pst.nnz_obs_names,<span class="st">"obsval"</span>].copy()</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>noise <span class="op">=</span> pst.ies.noise.copy()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,idx <span class="kw">in</span> <span class="bu">enumerate</span>(noise.index):</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    noise.loc[idx,hobs.obsnme] <span class="op">=</span> ovals[hobs.obsnme] <span class="op">+</span> offsets[i]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>noise.to_csv(os.path.join(t_d,<span class="st">"corrnoise.csv"</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(noise.loc[:,hobs.obsnme[<span class="dv">0</span>]]<span class="op">-</span>ovals.loc[hobs.obsnme[<span class="dv">0</span>]])</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(noise.loc[:,hobs.obsnme[<span class="dv">1</span>]]<span class="op">-</span>ovals.loc[hobs.obsnme[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>realization
0      -0.443167
1      -0.649668
2       0.268289
3      -0.327521
4       1.026350
          ...   
295    -0.247839
296    -0.026101
297    -1.487823
298    -0.089837
base    2.666098
Name: oname:at.csv_otype:lst_usecol:w01_time:1, Length: 300, dtype: float64
realization
0      -0.443167
1      -0.649668
2       0.268289
3      -0.327521
4       1.026350
          ...   
295    -0.247839
296    -0.026101
297    -1.487823
298    -0.089837
base    2.666098
Name: oname:at.csv_otype:lst_usecol:w03_time:1, Length: 300, dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_3446/2985994149.py:6: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
/tmp/ipykernel_3446/2985994149.py:7: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`</code></pre>
</div>
</div>
<div id="3b1f1a91-69ef-4b4c-843e-fb086612bca1" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:09:26.985367Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:09:26.984981Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:09:26.987625Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:09:26.987137Z&quot;}}" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>pst.pestpp_options[<span class="st">"ies_obs_en"</span>] <span class="op">=</span> <span class="st">"corrnoise.csv"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="9198acfb-8d2e-476b-95aa-3ca697d74741" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:09:26.988907Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:09:26.988765Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:09:26.992045Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:09:26.991659Z&quot;}}" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>pst.pestpp_options.pop(<span class="st">"ies_no_noise"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>True</code></pre>
</div>
</div>
<div id="8c53b396-fa4f-4f39-98ad-49b75029b577" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-07-18T11:09:26.993615Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-07-18T11:09:26.993249Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-07-18T11:13:23.379675Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-07-18T11:13:23.379134Z&quot;}}" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pst.write(os.path.join(t_d,<span class="st">"at.pst"</span>),version<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>m_d <span class="op">=</span> <span class="st">"master_ies_corrnoise"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>pyemu.os_utils.start_workers(t_d,<span class="st">"pestpp-ies"</span>,<span class="st">"at.pst"</span>,num_workers<span class="op">=</span><span class="dv">15</span>,master_dir<span class="op">=</span>m_d,worker_root<span class="op">=</span><span class="st">'.'</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plot_ies_results(m_d,<span class="st">"corr noise"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>noptmax:5, npar_adj:212, nnz_obs:36


             pestpp-ies: a GLM iterative ensemble smoother

                   by the PEST++ development team


version: 5.2.21
binary compiled on Jul 14 2025 at 14:36:32

started at 07/18/25 11:09:27
...processing command line: ' ./pestpp-ies at.pst /h :4004'
...using panther run manager in master mode using port 4004

using control file: "at.pst"
in directory: "/home/runner/work/PESTPP_Madison25/PESTPP_Madison25/notebooks/master_ies_corrnoise"
on host: "pkrvmq0rgcvqdmg"

processing control file at.pst


:~-._                                                 _.-~:
: :.~^o._        ________---------________        _.o^~.:.:
 : ::.`?88booo~~~.::::::::...::::::::::::..~~oood88P'.::.:
 :  ::: `?88P .:::....         ........:::::. ?88P' :::. :
  :  :::. `? .::.            . ...........:::. P' .:::. :
   :  :::   ... ..  ...       .. .::::......::.   :::. :
   `  :' .... ..  .:::::.     . ..:::::::....:::.  `: .'
    :..    ____:::::::::.  . . ....:::::::::____  ... :
   :... `:~    ^~-:::::..  .........:::::-~^    ~::.::::
   `.::. `\   (8)  \b:::..::.:.:::::::d/  (8)   /'.::::'
    ::::.  ~-._v    |b.::::::::::::::d|    v_.-~..:::::
    `.:::::... ~~^?888b..:::::::::::d888P^~...::::::::'
     `.::::::::::....~~~ .:::::::::~~~:::::::::::::::'
      `..:::::::::::   .   ....::::    ::::::::::::,'
        `. .:::::::    .      .::::.    ::::::::'.'
          `._ .:::    .        :::::.    :::::_.'
             `-. :    .        :::::      :,-'
                :.   :___     .:::___   .::
      ..--~~~~--:+::. ~~^?b..:::dP^~~.::++:--~~~~--..
        ___....--`+:::.    `~8~'    .:::+'--....___
      ~~   __..---`_=:: ___gd8bg___ :==_'---..__   ~~
       -~~~  _.--~~`-.~~~~~~~~~~~~~~~,-' ~~--._ ~~~-


               starting PANTHER master...

IP addresses:
  0.0.0.0:4004 (IPv4)

PANTHER master listening on socket: 0.0.0.0:4004 (IPv4)

  ---  initializing  ---  
...checking phi factors in file phi_factors.csv
...using glm algorithm
...using REDSVD for truncated svd solve
...maxsing: 10000000
...eigthresh:  1e-06
...initializing localizer
...not using localization
...using lambda multipliers: 0.1 , 1 , 10 , 
...using lambda scaling factors: 0.75 , 1 , 1.1 , 
...acceptable phi factor:  1.05
...lambda increase factor:  10
...lambda decrease factor:  0.75
...max run fail:  1
...initializing prior parameter covariance matrix
...parcov loaded  from parameter bounds, using par_sigma_range 4
...initializing observation noise covariance matrix
...obscov loaded  from observation weights
...using reg_factor:  0
...loading par ensemble from csv file prior.csv
...ies_num_reals arg passed, truncated parameter ensemble to  50
...not using prior parameter covariance matrix scaling
...loading obs ensemble from csv file corrnoise.csv
...ies_num_reals arg passed, truncated observation ensemble to  50
...setting weights ensemble from control file weights
...saved weight ensemble to  at.weights.csv
...adding 'base' parameter values to ensemble
...adding 'base' observation values to ensemble
...adding 'base' weight values to weight ensemble
...saved initial parameter ensemble to  at.0.par.csv
...saved obs+noise observation ensemble (obsval + noise realizations) to  at.obs+noise.csv
...using subset in lambda testing, percentage of realizations used in subset testing:  10
...subset how:  RANDOM
...centering on ensemble mean vector
...running initial ensemble of size 50
    running model 50 times
    starting at 07/18/25 11:09:27

    waiting for agents to appear...


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:09:28 mn:0     runs(C0    |F0    |T0    ) agents(R7   |W0   |U3   ) 0  07/18 11:09:29 mn:0     runs(C0    |F0    |T0    ) agents(R12  |W0   |U2   ) 0  07/18 11:09:30 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:31 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:32 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:33 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:34 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:35 mn:0.12  runs(C1    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:36 mn:0.12  runs(C13   |F0    |T0    ) agents(R14  |W0   |U1   ) 0  07/18 11:09:37 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:38 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:39 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:40 mn:0.12  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:41 mn:0.12  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:42 mn:0.12  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:43 mn:0.12  runs(C19   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:44 mn:0.12  runs(C30   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:45 mn:0.12  runs(C31   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:46 mn:0.12  runs(C32   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:47 mn:0.12  runs(C32   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:48 mn:0.12  runs(C32   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:49 mn:0.12  runs(C33   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:50 mn:0.12  runs(C34   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:51 mn:0.12  runs(C35   |F0    |T0    ) agents(R14  |W0   |U1   ) 0  07/18 11:09:52 mn:0.12  runs(C47   |F0    |T0    ) agents(R3   |W12  |U0   ) 0  07/18 11:09:53 mn:0.12  runs(C49   |F0    |T0    ) agents(R1   |W14  |U0   ) 0  07/18 11:09:53 remaining file transfers: 0

   50 runs complete :  0 runs failed
   0.115 avg run time (min) : 0.442 run mgr time (min)
   15 agents connected


...saved initial obs ensemble to at.0.obs.csv
saved par and rei files for realization BASE for iteration 0
saved par and rei files for realization BASE

  ---  pre-drop initial phi summary  ---  
       phi type           mean            std            min            max
       measured        2204.67        3093.31        19.4891        14418.1
         actual        2200.44        3226.06        18.7208        16422.3
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
rivgroup            2          0  1.24e+03  1.77e+03      1.58   8.1e+03      68.1      36.5
headgroup          31          0       965  3.07e+03      17.1  1.64e+04      31.9      36.5
headdiffgroup       3          3    0.0298    0.0231    0.0148     0.134   0.00654    0.0163

...checking for prior-data conflict

  ---  WARNING: 3 non-zero weighted observations are in conflict with the prior simulated ensemble.
  ---  
...see at.0.pdc.csv for listing of conflicted observations

...  WARNING: Prior-data conflict detected.  Continuing with IES parameter
           adjustment will likely result in parameter and forecast bias.


  ---  dropping realizations as bad:  4  ---  
...dropping par:obs realizations: 3 : 3 , 6 : 6 , 37 : 37 , 42 : 42 , 

  ---  adjusting weights using phi factors in file phi_factors.csv  ---  

  ---  pre-weight-adjustment initial phi summary  ---  
       phi type           mean            std            min            max
       measured        1437.13        1532.52        19.4891         6363.5
         actual        1403.84        1511.19        18.7208        6162.19
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
rivgroup            2          0  1.16e+03   1.5e+03      1.58  6.09e+03      71.9      33.3
headgroup          31          0       239       627      17.1   4.1e+03      28.1      33.3
headdiffgroup       3          3    0.0249    0.0101    0.0148    0.0719   0.00704    0.0169

...checking phi factors in file phi_factors.csv
...using mean residuals for reweighting
...original mean phi:  1437.13
...file tag 'HEADDIFFGROUP' original mean phi (factor): 0.0248823 (1.73138e-05)
...file tag 'HEADGROUP' original mean phi (factor): 256.003 (0.178135)
...file tag 'RIVGROUP' original mean phi (factor): 1181.1 (0.821848)
...file tag 'HEADDIFFGROUP' adjusted mean phi (factor): 1.43713e-27 (1e-30)
...file tag 'HEADGROUP' adjusted mean phi (factor): 1149.7 (0.8)
...file tag 'RIVGROUP' adjusted mean phi (factor): 287.426 (0.2)
...saved adjusted weight ensemble to  at.adjusted.weights.csv
saved par and rei files for realization BASE for iteration 0
saved par and rei files for realization BASE

  ---  initial phi summary  ---  
       phi type           mean            std            min            max
       measured        1437.13        2799.76        78.1833        17662.3
         actual        1356.61        2765.05        77.2596        18406.1
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0  1.07e+03  2.81e+03      76.9  1.84e+04      65.9      29.2
rivgroup            2          0       283       366     0.385  1.48e+03      34.1      29.2
headdiffgroup       3          3  1.44e-27  5.84e-28  8.54e-28  4.15e-27  2.62e-28  2.67e-28

...current lambda: 10

  ---  initialization complete  ---  

  ---  starting solve for iteration: 1  ---  
...current lambda:  10
...starting calcs for glm factor 1
...finished calcs for: 1
...starting calcs for glm factor 10
...finished calcs for: 10
...starting calcs for glm factor 100
...finished calcs for: 100

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:0, 6:8, 11:13, 45:BASE, 
...subset idx:oe real name:  0:0, 6:8, 11:13, 45:BASE, 
    running model 36 times
    starting at 07/18/25 11:09:54
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:09:55 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:56 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:57 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:58 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:09:59 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:00 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:01 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:02 mn:0.13  runs(C1    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:03 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:04 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:05 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:06 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:07 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:08 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:09 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:10 mn:0.14  runs(C18   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:11 mn:0.14  runs(C24   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:10:12 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:10:13 mn:0.14  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:10:14 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.124 avg run time (min) : 0.333 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  1437.13
...last stdev:  2799.76

  ---  phi summary for best lambda, scale fac: 1 , 1 ,   ---  
       phi type           mean            std            min            max
       measured        81.1582        47.1679        24.0043        130.159
         actual        103.825        77.1691        24.0043        172.154
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.

  ---  running remaining realizations for best lambda, scale:1 , 1 ,   ---  
    running model 42 times
    starting at 07/18/25 11:10:14
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:10:15 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:16 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:17 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:18 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:19 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:20 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:21 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:22 mn:0.13  runs(C1    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:23 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:24 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:25 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:26 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:27 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:28 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:29 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:30 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:31 mn:0.14  runs(C30   |F0    |T0    ) agents(R12  |W3   |U0   ) 0  07/18 11:10:32 mn:0.14  runs(C31   |F0    |T0    ) agents(R11  |W4   |U0   ) 0  07/18 11:10:33 mn:0.14  runs(C31   |F0    |T0    ) agents(R11  |W4   |U0   ) 0  07/18 11:10:34 mn:0.14  runs(C31   |F0    |T0    ) agents(R11  |W4   |U0   ) 0  07/18 11:10:35 mn:0.14  runs(C31   |F0    |T0    ) agents(R11  |W4   |U0   ) 0  07/18 11:10:36 mn:0.14  runs(C32   |F0    |T0    ) agents(R10  |W5   |U0   ) 0  07/18 11:10:37 mn:0.13  runs(C37   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:10:37 remaining file transfers: 0

   42 runs complete :  0 runs failed
   0.124 avg run time (min) : 0.387 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  2  ---  
...dropping par:obs realizations: 28 : 28 , 47 : 47 , 
...phi summary for entire ensemble using lambda,scale_fac 1 , 1 , 
       phi type           mean            std            min            max
       measured        128.226        92.9302        24.0043        350.758
         actual        120.845        98.5335        20.6365        496.317
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
...last best mean phi * acceptable phi factor:  1508.99
...current best mean phi:  128.226

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.75  ---  

  ---  EnsembleMethod iteration 1 report  ---  
   number of active realizations:   44
   number of model runs:            128
      current obs ensemble saved to at.1.obs.csv
      current par ensemble saved to at.1.par.csv
saved par and rei files for realization BASE for iteration 1
saved par and rei files for realization BASE
       phi type           mean            std            min            max
       measured        128.226        92.9302        24.0043        350.758
         actual        120.845        98.5335        20.6365        496.317
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0       109        97      10.1       461      84.3      13.1
rivgroup            2          0      11.8      6.86     0.169        35      15.7      13.1
headdiffgroup       3          3  1.23e-27  9.73e-29  1.03e-27  1.46e-27  1.84e-27  1.45e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1    0.1322    14.81          1      2.273          0          0           0
riverbed          1     1.154    37.87          0          0          0          0           0
pp-k_clay.ref   104      1257    14.76          1    0.02185          3    0.06556           0
pp-k_aq.ref     104      1009    28.79          1    0.02185          0          0           0
cn-k_clay.ref     1     22.23    3.706          0          0          0          0           0
cn-k_aq.ref       1     4.126    59.67          0          0          0          0           0

...saved parameter change summary to at.1.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1437.13 , 128.226 , 
...best phi yet:  128.226
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 2  ---  
...current lambda:  0.75
...starting calcs for glm factor 0.075
...finished calcs for: 0.075
...starting calcs for glm factor 0.75
...finished calcs for: 0.75
...starting calcs for glm factor 7.5
...finished calcs for: 7.5

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  3:BASE, 5:2, 22:23, 34:36, 
...subset idx:oe real name:  3:BASE, 5:2, 22:23, 34:36, 
    running model 36 times
    starting at 07/18/25 11:10:37
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:10:38 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:39 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:40 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:41 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:42 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:43 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:44 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:45 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:46 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:47 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:48 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:49 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:50 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:51 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:52 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:53 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:54 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W5   |U4   ) 0  07/18 11:10:55 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:10:56 mn:0.14  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:10:57 mn:0.13  runs(C32   |F0    |T0    ) agents(R4   |W11  |U0   ) 0  07/18 11:10:57 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.124 avg run time (min) : 0.339 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  128.226
...last stdev:  92.9302

  ---  phi summary for best lambda, scale fac: 0.075 , 1 ,   ---  
       phi type           mean            std            min            max
       measured        14.2727        9.42598         6.4486         27.767
         actual        73.4769        109.032         6.4486        236.469
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.

  ---  running remaining realizations for best lambda, scale:0.075 , 1 ,   ---  
    running model 40 times
    starting at 07/18/25 11:10:57
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:10:58 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:10:59 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:00 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:01 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:02 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:03 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:04 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:05 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:06 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:07 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:08 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:09 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:10 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:11 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:12 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:13 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:14 mn:0.14  runs(C21   |F0    |T0    ) agents(R10  |W1   |U4   ) 0  07/18 11:11:15 mn:0.14  runs(C30   |F0    |T0    ) agents(R10  |W5   |U0   ) 0  07/18 11:11:16 mn:0.14  runs(C31   |F0    |T0    ) agents(R9   |W6   |U0   ) 0  07/18 11:11:17 mn:0.14  runs(C31   |F0    |T0    ) agents(R9   |W6   |U0   ) 0  07/18 11:11:18 mn:0.14  runs(C31   |F0    |T0    ) agents(R9   |W6   |U0   ) 0  07/18 11:11:19 mn:0.14  runs(C31   |F0    |T0    ) agents(R9   |W6   |U0   ) 0  07/18 11:11:20 remaining file transfers: 0

   40 runs complete :  0 runs failed
   0.123 avg run time (min) : 0.379 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  4  ---  
...dropping par:obs realizations: 19 : 19 , 21 : 21 , 31 : 31 , 33 : 33 , 
...phi summary for entire ensemble using lambda,scale_fac 0.075 , 1 , 
       phi type           mean            std            min            max
       measured         15.421        5.93808         6.4486        30.9346
         actual        92.7412        87.9383         6.4486        362.181
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
...last best mean phi * acceptable phi factor:  134.637
...current best mean phi:  15.421

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.05625  ---  

  ---  EnsembleMethod iteration 2 report  ---  
   number of active realizations:   40
   number of model runs:            204
      current obs ensemble saved to at.2.obs.csv
      current par ensemble saved to at.2.par.csv
saved par and rei files for realization BASE for iteration 2
saved par and rei files for realization BASE
       phi type           mean            std            min            max
       measured         15.421        5.93808         6.4486        30.9346
         actual        92.7412        87.9383         6.4486        362.181
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0      89.2      87.7      3.13       361      89.7      12.8
rivgroup            2          0      3.52      1.85      0.28      7.19      10.3      12.8
headdiffgroup       3          3  1.27e-27  1.72e-28     1e-27  1.74e-27  4.01e-27  4.54e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1    0.1831    26.97          1        2.5          0          0           0
riverbed          1     3.241    29.71          0          0          0          0           0
pp-k_clay.ref   104      1421    21.37          0          0          0          0           0
pp-k_aq.ref     104      1222    36.96          1    0.02404          1    0.02404           0
cn-k_clay.ref     1     479.3    27.36          0          0          0          0           0
cn-k_aq.ref       1     26.06    56.85          0          0          0          0           0

...saved parameter change summary to at.2.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1437.13 , 128.226 , 15.421 , 
...best phi yet:  15.421
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 3  ---  
...current lambda:  0.05625
...starting calcs for glm factor 0.005625
...finished calcs for: 0.005625
...starting calcs for glm factor 0.05625
...finished calcs for: 0.05625
...starting calcs for glm factor 0.5625
...finished calcs for: 0.5625

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:BASE, 11:9, 27:30, 32:39, 
...subset idx:oe real name:  0:BASE, 11:9, 27:30, 32:39, 
    running model 36 times
    starting at 07/18/25 11:11:20
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:11:21 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:22 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:23 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:24 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:25 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:26 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:27 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:28 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:29 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:30 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:31 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:32 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:33 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:34 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:35 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:36 mn:0.14  runs(C17   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:37 mn:0.14  runs(C23   |F0    |T0    ) agents(R13  |W2   |U0   ) 0  07/18 11:11:38 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:11:39 mn:0.14  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:11:40 mn:0.13  runs(C35   |F0    |T0    ) agents(R1   |W14  |U0   ) 0  07/18 11:11:40 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.124 avg run time (min) : 0.336 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  15.421
...last stdev:  5.93808

  ---  phi summary for best lambda, scale fac: 0.005625 , 1.1 ,   ---  
       phi type           mean            std            min            max
       measured        9.94811         4.6834        4.82293        15.3405
         actual        77.7388        87.4472        4.82293        185.625
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.

  ---  running remaining realizations for best lambda, scale:0.005625 , 1.1 ,   ---  
    running model 36 times
    starting at 07/18/25 11:11:41
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:11:42 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:43 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:44 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:45 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:46 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:47 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:48 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:49 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:50 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:51 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:52 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:53 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:54 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:55 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:56 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:57 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:11:58 mn:0.14  runs(C25   |F0    |T0    ) agents(R11  |W4   |U0   ) 0  07/18 11:11:59 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:12:00 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:12:01 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:12:01 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.126 avg run time (min) : 0.347 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  3  ---  
...dropping par:obs realizations: 8 : 8 , 13 : 13 , 43 : 43 , 
...phi summary for entire ensemble using lambda,scale_fac 0.005625 , 1.1 , 
       phi type           mean            std            min            max
       measured        9.47453        3.12794        4.58593        17.0669
         actual        65.2703        63.9234        4.82293        247.638
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
...last best mean phi * acceptable phi factor:  16.1921
...current best mean phi:  9.47453

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.00421875  ---  

  ---  EnsembleMethod iteration 3 report  ---  
   number of active realizations:   37
   number of model runs:            276
      current obs ensemble saved to at.3.obs.csv
      current par ensemble saved to at.3.par.csv
saved par and rei files for realization BASE for iteration 3
saved par and rei files for realization BASE
       phi type           mean            std            min            max
       measured        9.47453        3.12794        4.58593        17.0669
         actual        65.2703        63.9234        4.82293        247.638
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0      62.9      63.8       2.7       247      89.9      12.6
rivgroup            2          0      2.33      1.47     0.226      5.48      10.1      12.6
headdiffgroup       3          3  1.28e-27  1.46e-28  1.07e-27  1.67e-27  6.09e-27  6.71e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1   0.07837    29.64          1      2.703          0          0           0
riverbed          1     4.438    39.93          0          0          0          0           0
pp-k_clay.ref   104      1560    25.74          0          0          0          0           0
pp-k_aq.ref     104      1362    42.33          0          0          1    0.02599           0
cn-k_clay.ref     1     547.3    31.74          0          0          0          0           0
cn-k_aq.ref       1      4.87    61.98          0          0          0          0           0

...saved parameter change summary to at.3.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1437.13 , 128.226 , 15.421 , 9.47453 , 
...best phi yet:  9.47453
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 4  ---  
...current lambda:  0.00421875
...starting calcs for glm factor 0.000421875
...finished calcs for: 0.000421875
...starting calcs for glm factor 0.00421875
...finished calcs for: 0.00421875
...starting calcs for glm factor 0.0421875
...finished calcs for: 0.0421875

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:BASE, 14:12, 26:29, 36:48, 
...subset idx:oe real name:  0:BASE, 14:12, 26:29, 36:48, 
    running model 36 times
    starting at 07/18/25 11:12:01
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:12:02 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:03 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:04 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:05 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:06 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:07 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:08 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:09 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:10 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:11 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:12 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:13 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:14 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:15 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:16 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:17 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:19 mn:0.14  runs(C25   |F0    |T0    ) agents(R9   |W1   |U5   ) 0  07/18 11:12:20 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:12:21 mn:0.14  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:12:22 mn:0.14  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:12:22 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.125 avg run time (min) : 0.343 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  9.47453
...last stdev:  3.12794

  ---  phi summary for best lambda, scale fac: 0.000421875 , 1.1 ,   ---  
       phi type           mean            std            min            max
       measured         6.9653        1.92244        4.20668        8.63221
         actual        22.9451        13.6847        4.20668        35.1812
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.

  ---  running remaining realizations for best lambda, scale:0.000421875 , 1.1 ,   ---  
    running model 33 times
    starting at 07/18/25 11:12:22
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:12:23 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:24 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:25 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:26 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:27 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:28 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:29 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:30 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:31 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:32 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:33 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:34 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:35 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:36 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:37 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:38 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:39 mn:0.14  runs(C30   |F0    |T0    ) agents(R3   |W12  |U0   ) 0  07/18 11:12:40 mn:0.14  runs(C30   |F0    |T0    ) agents(R3   |W12  |U0   ) 0  07/18 11:12:41 remaining file transfers: 0

   33 runs complete :  0 runs failed
   0.13 avg run time (min) : 0.317 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  2  ---  
...dropping par:obs realizations: 30 : 30 , 10 : 10 , 
...phi summary for entire ensemble using lambda,scale_fac 0.000421875 , 1.1 , 
       phi type           mean            std            min            max
       measured        7.64149        2.48512        4.07364        12.5945
         actual        60.0113        62.9862        4.20668         277.67
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
...last best mean phi * acceptable phi factor:  9.94826
...current best mean phi:  7.64149

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  0.000316406  ---  

  ---  EnsembleMethod iteration 4 report  ---  
   number of active realizations:   35
   number of model runs:            345
      current obs ensemble saved to at.4.obs.csv
      current par ensemble saved to at.4.par.csv
saved par and rei files for realization BASE for iteration 4
saved par and rei files for realization BASE
       phi type           mean            std            min            max
       measured        7.64149        2.48512        4.07364        12.5945
         actual        60.0113        62.9862        4.20668         277.67
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0      58.4      63.1      2.67       277      91.5        11
rivgroup            2          0      1.61      1.12      0.16      4.28      8.47        11
headdiffgroup       3          3  1.29e-27  1.49e-28  1.08e-27  1.69e-27  7.12e-27  8.09e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
recharge          1    0.1128    32.29          1      2.857          0          0           0
riverbed          1     5.555    49.03          0          0          0          0           0
pp-k_clay.ref   104      1736    26.46          0          0          0          0           0
pp-k_aq.ref     104      1496    43.47          0          0          1    0.02747           0
cn-k_clay.ref     1     602.7    32.86          0          0          0          0           0
cn-k_aq.ref       1     29.75    62.17          0          0          0          0           0

...saved parameter change summary to at.4.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1437.13 , 128.226 , 15.421 , 9.47453 , 7.64149 , 
...best phi yet:  7.64149
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0

  ---  starting solve for iteration: 5  ---  
...current lambda:  0.000316406
...starting calcs for glm factor 3.16406e-05
...finished calcs for: 3.16406e-05
...starting calcs for glm factor 0.000316406
...finished calcs for: 0.000316406
...starting calcs for glm factor 0.00316406
...finished calcs for: 0.00316406

  ---  running upgrade ensembles  ---  
...subset idx:pe real name:  0:BASE, 13:7, 15:14, 32:44, 
...subset idx:oe real name:  0:BASE, 13:7, 15:14, 32:44, 
    running model 36 times
    starting at 07/18/25 11:12:41
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:12:42 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:43 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:44 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:45 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:46 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:47 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:48 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:49 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:50 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:51 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:52 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:53 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:54 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:55 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:56 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:57 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:12:58 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:12:59 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:13:00 mn:0.14  runs(C30   |F0    |T0    ) agents(R6   |W9   |U0   ) 0  07/18 11:13:01 mn:0.14  runs(C31   |F0    |T0    ) agents(R5   |W10  |U0   ) 0  07/18 11:13:02 remaining file transfers: 0

   36 runs complete :  0 runs failed
   0.124 avg run time (min) : 0.342 run mgr time (min)
   15 agents connected



  ---  evaluating upgrade ensembles  ---  
...last mean:  7.64149
...last stdev:  2.48512

  ---  phi summary for best lambda, scale fac: 3.16406e-05 , 1.1 ,   ---  
       phi type           mean            std            min            max
       measured        7.89964        3.45816        3.78291        11.8105
         actual        67.6739        70.4288        3.78291        140.046
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.

  ---  running remaining realizations for best lambda, scale:3.16406e-05 , 1.1 ,   ---  
    running model 31 times
    starting at 07/18/25 11:13:02
    15 agents ready


PANTHER progress
   avg = average model run time in minutes
   runs(C = completed | F = failed | T = timed out)
   agents(R = running | W = waiting | U = unavailable)
--------------------------------------------------------------------------------
07/18 11:13:03 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:04 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:05 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:06 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:07 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:08 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:09 mn:0     runs(C0    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:10 mn:0.13  runs(C1    |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:11 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:12 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:13 mn:0.14  runs(C15   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:14 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:15 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:16 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:17 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:18 mn:0.14  runs(C16   |F0    |T0    ) agents(R15  |W0   |U0   ) 0  07/18 11:13:19 mn:0.14  runs(C30   |F0    |T0    ) agents(R1   |W13  |U1   ) 0  07/18 11:13:19 remaining file transfers: 0

   31 runs complete :  0 runs failed
   0.138 avg run time (min) : 0.292 run mgr time (min)
   15 agents connected



  ---  dropping realizations as bad:  2  ---  
...dropping par:obs realizations: 14 : 14 , 25 : 25 , 
...phi summary for entire ensemble using lambda,scale_fac 3.16406e-05 , 1.1 , 
       phi type           mean            std            min            max
       measured         6.4965        2.10287        3.17162         9.9619
         actual        52.8317        57.3854        3.78291        246.305
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
...last best mean phi * acceptable phi factor:  8.02357
...current best mean phi:  6.4965

  ---  updating parameter ensemble  ---  

  ---  updating lambda to  2.37305e-05  ---  

  ---  EnsembleMethod iteration 5 report  ---  
   number of active realizations:   33
   number of model runs:            412
      current obs ensemble saved to at.5.obs.csv
      current par ensemble saved to at.5.par.csv
saved par and rei files for realization BASE for iteration 5
saved par and rei files for realization BASE
       phi type           mean            std            min            max
       measured         6.4965        2.10287        3.17162         9.9619
         actual        52.8317        57.3854        3.78291        246.305
     note: 'measured' phi reported above includes 
           realizations of measurement noise, 
           'actual' phi does not.
  ---  observation group phi summary ---  
       (computed using 'actual' phi)
           (sorted by mean phi)
group           count  nconflict      mean       std       min       max   percent       std
headgroup          31          0      51.5      57.4      2.56       246      92.2      10.2
rivgroup            2          0       1.3     0.996     0.123       3.6      7.76      10.2
headdiffgroup       3          3   1.3e-27  1.41e-28   1.1e-27  1.67e-27  8.21e-27  9.29e-27


   ---  parameter group change summary  ---    
group         count  mean chg  std chg  n at ubnd  % at ubnd  n at lbnd  % at lbnd  n std decr
riverbed          1     6.118    57.69          0          0          0          0           0
recharge          1    0.1176    35.13          0          0          0          0           0
pp-k_clay.ref   104      1926    29.63          0          0          0          0           0
pp-k_aq.ref     104      1545    45.05          0          0          1    0.02914           0
cn-k_clay.ref     1     664.2    38.09          0          0          0          0           0
cn-k_aq.ref       1     50.55    63.36          0          0          0          0           0

...saved parameter change summary to at.5.pcs.csv

  ---  phi-based termination criteria check  ---  
...phiredstp:  0.01
...nphistp:  3
...nphinored (also used for consecutive bad lambda cycles):  3
...best mean phi sequence: 1437.13 , 128.226 , 15.421 , 9.47453 , 7.64149 , 6.4965 , 
...best phi yet:  6.4965
...number of consecutive bad lambda testing cycles:  0
...number of iterations satisfying phiredstp criteria:  1
...number of iterations since best yet mean phi:  0
...solution iterations &gt;= noptmax, all done


pestpp-ies analysis complete...
started at 07/18/25 11:09:27
finished at 07/18/25 11:13:19
took 3.86667 minutes</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-25-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-25-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-25-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-25-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-25-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-25-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="simple_ies_files/figure-html/cell-25-output-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>